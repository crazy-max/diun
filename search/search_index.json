{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#what-is-diun","title":"What is Diun?","text":"<p>Docker Image Update Notifier is a CLI application written in Go and delivered as a single executable (and a Docker image) to receive notifications when a Docker image is updated on a Docker registry.</p> <p>With Go, this can be done with an independent binary distribution across all platforms and architectures that Go supports. This support includes Linux, macOS, and Windows, on architectures like amd64, i386, ARM, PowerPC, and others.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Allow watching a Docker repository and report new tags</li> <li>Include and exclude filters with regular expression for tags</li> <li>Internal cron implementation through go routines</li> <li>Worker pool to parallelize analyses</li> <li>Allow overriding image os and architecture</li> <li>Docker, Kubernetes, Swarm,   Nomad, Dockerfile and File   providers available</li> <li>Get notified through Gotify, Mail, Slack, Telegram and more</li> <li>Healthchecks support to monitor Diun watcher</li> <li>Enhanced logging</li> <li>Official Docker image available</li> </ul>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the terms of the MIT license.</p>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#4310-20251224","title":"4.31.0 (2025/12/24)","text":"<ul> <li>Support for negating namespaces with Kubernetes provider (#1582)</li> <li>Support new Matrix servers for Matrix notifications (#1529 #1551)</li> <li>Use <code>X-Gotify-Key</code> header to send token for Gotify (#1530)</li> <li>Add RFC 5322 compliant Message-ID header to email notifications (#1557)</li> <li>Add <code>renderEmbeds</code> option for Discord notifications (#1580)</li> <li>Go 1.25 (#1573)</li> <li>Alpine Linux 3.23 (#1572)</li> <li>MkDocs Material 9.6.20 (#1509)</li> <li>Bump github.com/alecthomas/kong to 1.13.0 (#1545)</li> <li>Bump github.com/containerd/platforms to 1.0.0-rc.2 (#1533)</li> <li>Bump github.com/docker/docker to 28.5.2+incompatible (#1517)</li> <li>Bump github.com/dromara/carbon/v2 to 2.6.15 (#1526 #1546)</li> <li>Bump github.com/eclipse/paho.mqtt.golang to 1.5.1 (#1504)</li> <li>Bump github.com/jedib0t/go-pretty/v6 to 6.7.8 (#1569 #1583)</li> <li>Bump github.com/go-playground/validator/v10 to 10.30.0 (#1513 #1576)</li> <li>Bump github.com/hashicorp/nomad/api to 1.11.1 (#1579)</li> <li>Bump github.com/moby/buildkit to 0.25.3 (#1516 #1566)</li> <li>Bump go.podman.io/image/v5 to 5.38.0 (#1502 #1535)</li> <li>Bump golang.org/x/mod to 0.30.0 (#1540)</li> <li>Bump google.golang.org/grpc to 1.78.0 (#1565 #1584)</li> <li>Bump google.golang.org/grpc/cmd/protoc-gen-go-grpc to 1.6.0 (#1577)</li> <li>Bump google.golang.org/protobuf to 1.36.11 (#1564)</li> <li>Bump k8s.io/client-go to 0.34.1 (#1501)</li> <li>Bump maunium.net/go/mautrix from 0.25.2 to 0.26.1 (#1567)</li> </ul>"},{"location":"changelog/#4300-20250831","title":"4.30.0 (2025/08/31)","text":"<ul> <li>Add TLS config options <code>tlsSkipVerify</code> and <code>tlsCaCertFiles</code> for all notifiers using an HTTP client (#1489)</li> <li>Apprise notifications support (#1457)</li> <li>Elasticsearch notifications support (#1452)</li> <li>Add <code>disableNotification</code> option for Telegram (#1354)</li> <li>Switch from third-party module to HTTP client for Pushover (#1490)</li> <li>Align <code>chatIDs</code> and <code>chatIDsFile</code> format handling for Telegram (#1316)</li> <li>Switch from <code>github.com/hako/durafmt</code> to <code>github.com/dromara/carbon</code> module (#1317)</li> <li>Remove unneeded <code>openssl</code> package in the Docker image (#1488)</li> <li>Go 1.24 (#1461)</li> <li>Alpine Linux 3.22 (#1462)</li> <li>Bump dario.cat/mergo to 1.0.2 (#1436)</li> <li>Bump github.com/alecthomas/kong to 1.12.1 (#1324 #1456)</li> <li>Bump github.com/containers/image/v5 to 5.36.1 (#1340 #1454 #1467)</li> <li>Bump github.com/crazy-max/gohealthchecks to 0.5.0 (#1319)</li> <li>Bump github.com/docker/docker to 28.3.3+incompatible (#1458)</li> <li>Bump github.com/docker/go-connections to 0.6.0 (#1470)</li> <li>Bump github.com/dromara/carbon/v2 to 2.6.11 (#1435 #1455)</li> <li>Bump github.com/go-playground/validator/v10 to 10.27.0 (#1333 #1432 #1446)</li> <li>Bump github.com/hashicorp/nomad/api to 1.10.4 (#1487)</li> <li>Bump github.com/jedib0t/go-pretty/v6 to 6.6.8 (#1430 #1466)</li> <li>Bump github.com/moby/buildkit to 0.23.2 (#1445)</li> <li>Bump github.com/opencontainers/image-spec to 1.1.1 (#1434)</li> <li>Bump github.com/panjf2000/ants/v2 to 2.11.3 (#1331 #1433)</li> <li>Bump github.com/PaulSonOfLars/gotgbot/v2 to 2.0.0-rc.33 (#1397 #1448)</li> <li>Bump github.com/rs/zerolog to 1.34.0 (#1431)</li> <li>Bump github.com/stretchr/testify to 1.11.1 (#1482)</li> <li>Bump go.etcd.io/bbolt to 1.4.3 (#1361 #1444 #1477)</li> <li>Bump golang.org/x/crypto to 0.35.0 (#1398)</li> <li>Bump golang.org/x/mod to 0.27.0 (#1377 #1450 #1469)</li> <li>Bump golang.org/x/net to 0.38.0 (#1343 #1402)</li> <li>Bump golang.org/x/sys to 0.35.0 (#1323 #1427 #1472)</li> <li>Bump google.golang.org/grpc to 1.74.2 (#1407 #1465)</li> <li>Bump google.golang.org/protobuf to 1.36.8 (#1389 #1471 #1479)</li> <li>Bump k8s.io/client-go to 0.32.1 (#1338 #1453)</li> </ul>"},{"location":"changelog/#4290-20241219","title":"4.29.0 (2024/12/19)","text":"<p> See Migration notes in the documentation before upgrading.</p> <ul> <li>Topics support for Telegram notifications (#1308)</li> <li>Webhook url as secret support for Discord, Slack and Teams notifications (#1302)</li> <li>Enhance error message for JSON decode response issues for Gotify, ntfy and RocketChat (#1309)</li> <li>Fix TLS configuration handling for Nomad provider (#1178)</li> <li>Go 1.23 (#1286)</li> <li>Alpine Linux 3.21 (#1286)</li> <li>Switch to github.com/containerd/platforms v0.2.1 (#1287)</li> <li>Switch to github.com/rabbitmq/amqp091-go v1.10.0 (#1288)</li> <li>Bump dario.cat/mergo to 1.0.1 (#1301)</li> <li>Bump github.com/alecthomas/kong from 0.9.0 to 1.6.0 (#1298)</li> <li>Bump github.com/containers/image/v5 to 5.33.0 (#1274 #1284)</li> <li>Bump github.com/distribution/reference from 0.5.0 to 0.6.0 (#1183)</li> <li>Bump github.com/docker/docker to 27.3.1+incompatible (#1181 #1275 #1291)</li> <li>Bump github.com/eclipse/paho.mqtt.golang to 1.5.0 (#1299)</li> <li>Bump github.com/go-playground/validator/v10 to 10.23.0 (#1179 #1191 #1297)</li> <li>Bump github.com/gregdel/pushover to 1.3.1 (#1164)</li> <li>Bump github.com/jedib0t/go-pretty/v6 to 6.6.5 (#1167 #1300)</li> <li>Bump github.com/microcosm-cc/bluemonday to 1.0.27 (#1294)</li> <li>Bump github.com/moby/buildkit to 0.17.3 (#1160 #1312)</li> <li>Bump github.com/panjf2000/ants/v2 to 2.10.0 (#1198)</li> <li>Bump github.com/PaulSonOfLars/gotgbot/v2 to 2.0.0-rc.30 (#1185 #1278)</li> <li>Bump github.com/rs/zerolog to 1.33.0 (#1186)</li> <li>Bump github.com/stretchr/testify to 1.10.0 (#1295)</li> <li>Bump go.etcd.io/bbolt to 1.3.11 (#1187 #1292)</li> <li>Bump golang.org/x/crypto to 0.31.0 (#1271)</li> <li>Bump golang.org/x/mod to 0.22.0 (#1188 #1296)</li> <li>Bump golang.org/x/net to 0.23.0 (#1157)</li> <li>Bump golang.org/x/sys to 0.25.0 (#1184 #1240)</li> <li>Bump google.golang.org/grpc to 1.67.0 (#1171 #1293)</li> <li>Bump google.golang.org/grpc/cmd/protoc-gen-go-grpc to 1.5.1 (#1224)</li> <li>Bump google.golang.org/protobuf to 1.35.2 (#1277)</li> <li>Bump k8s.io/client-go to 0.32.0 (#1280)</li> </ul>"},{"location":"changelog/#4280-20240406","title":"4.28.0 (2024/04/06)","text":"<ul> <li>Add <code>tzdata</code> package to Docker image (#1144)</li> <li>Alpine Linux 3.19 (#1140)</li> <li>Bump github.com/jedib0t/go-pretty/v6 to 6.5.6 (#1137)</li> <li>Bump github.com/panjf2000/ants/v2 to 2.9.1 (#1139)</li> <li>Bump golang.org/x/mod to 0.17.0 (#1143)</li> <li>Bump golang.org/x/sys to 0.19.0 (#1142)</li> <li>Bump google.golang.org/grpc to 1.63.0 (#1141)</li> </ul>"},{"location":"changelog/#4270-20240323","title":"4.27.0 (2024/03/23)","text":"<ul> <li>Sound option support for pushover (#996)</li> <li>Fix NTFY markdown (#1025)</li> <li>Fix global defaults for file provider (#1063)</li> <li>Switch to <code>github.com/PaulSonOfLars/gotgbot/v2</code> for Telegram API client (#1135)</li> <li>Go 1.21 (#1026 #1050 #1058)</li> <li>Generate sbom and provenance (#1116)</li> <li>Bump github.com/alecthomas/kong to 0.9.0 (#1041 #1118)</li> <li>Bump github.com/containerd/containerd to 1.7.14 (#1047 #1124)</li> <li>Bump github.com/containers/image/v5 to 5.30.0 (#1029 #1112)</li> <li>Bump github.com/docker/distribution to 2.8.3+incompatible (#991)</li> <li>Bump github.com/docker/docker to 25.0.5+incompatible (#1120 #1134)</li> <li>Bump github.com/go-playground/validator/v10 to 10.19.0 (#1020 #1109)</li> <li>Bump github.com/hashicorp/nomad/api to 1.7.2 (#1049)</li> <li>Bump github.com/jedib0t/go-pretty/v6 to 6.5.5 (#1012 #1083 #1126)</li> <li>Bump github.com/microcosm-cc/bluemonday to 1.0.26 (#1042)</li> <li>Bump github.com/moby/buildkit to 0.13.1 (#1043 #1111 #1117 #1128)</li> <li>Bump github.com/opencontainers/image-spec to 1.1.0 (#1100)</li> <li>Bump github.com/panjf2000/ants/v2 to 2.9.0 (#1046)</li> <li>Bump github.com/rs/zerolog to 1.32.0 (#989 #1121)</li> <li>Bump go.etcd.io/bbolt to 1.3.9 (#1044 #1106)</li> <li>Bump golang.org/x/crypto to 0.17.0 (#1060)</li> <li>Bump golang.org/x/mod to 0.16.0 (#1021 #1110)</li> <li>Bump golang.org/x/net to 0.17.0 (#1002)</li> <li>Bump golang.org/x/sys to 0.17.0 (#1035 #1092)</li> <li>Bump google.golang.org/grpc to 1.62.1 (#1048 #1061 #1113)</li> <li>Bump google.golang.org/protobuf to 1.33.0 (#1064 #1119)</li> <li>Bump k8s.io/client-go to 0.29.3 (#1045 #1051 #1098 #1127)</li> </ul>"},{"location":"changelog/#4260-20230923","title":"4.26.0 (2023/09/23)","text":"<ul> <li>Global <code>defaults</code> support for image configuration (#887 #981 #982)</li> <li><code>image:tag@digest</code> format support (#915)</li> <li>Handle analysis of images with tag and digest (#968)</li> <li>Fix latest for <code>image list</code> command (#983)</li> <li>Fix dead link in reporting-issue docs (#963)</li> <li>Alpine Linux 3.18 (#914)</li> <li>Bump github.com/AlecAivazis/survey/v2 to 2.3.7 (#900)</li> <li>Bump github.com/alecthomas/kong to 0.8.0 (#905)</li> <li>Bump github.com/containerd/containerd to 1.7.6 (#954)</li> <li>Bump github.com/containers/image/v5 to 5.26.1 (#911)</li> <li>Bump github.com/docker/docker to 24.0.6+incompatible (#947)</li> <li>Bump github.com/eclipse/paho.mqtt.golang to 1.4.3 (#920)</li> <li>Bump github.com/go-playground/validator/v10 to 10.15.4 (#972)</li> <li>Bump github.com/gregdel/pushover to 1.3.0 (#975)</li> <li>Bump github.com/jedib0t/go-pretty/v6 to 6.4.7 (#971)</li> <li>Bump github.com/microcosm-cc/bluemonday to 1.0.25 (#927)</li> <li>Bump github.com/moby/buildkit to 0.12.2 (#940)</li> <li>Bump github.com/opencontainers/image-spec to 1.1.0-rc5 (#912 #974)</li> <li>Bump github.com/panjf2000/ants/v2 to 2.8.2 (#913 #922 #978)</li> <li>Bump github.com/rs/zerolog to 1.30.0 (#976)</li> <li>Bump github.com/streadway/amqp to 1.1.0 (#904)</li> <li>Bump golang.org/x/mod to 0.12.0 (#901 #917)</li> <li>Bump golang.org/x/sys to 0.12.0 (#899 #945)</li> <li>Bump google.golang.org/grpc to 1.58.2 (#906 #961 #980)</li> <li>Bump google.golang.org/protobuf to 1.31.0 (#908)</li> <li>Bump k8s.io/client-go to 0.28.2 (#960)</li> </ul>"},{"location":"changelog/#4250-20230612","title":"4.25.0 (2023/06/12)","text":"<ul> <li><code>runOnStartup</code> watch option (#895)</li> <li>ntfy notification support (#787)</li> <li>Authentication support for ntfy (#890)</li> <li>Sorting for prefixed semver (#765)</li> <li>Check Nomad group meta tags (#763)</li> <li>Go 1.20 (#858)</li> <li>Bump github.com/docker/docker 24.0.2+incompatible (#851 #883)</li> <li>Bump github.com/containers/image/v5 to 5.25.0 (#772 #791 #796 #855)</li> <li>Bump github.com/containerd/containerd to 1.7.2 (#757 #792 #885)</li> <li>Bump github.com/moby/buildkit to 0.11.6 (#790 #809 #848)</li> <li>Bump github.com/crazy-max/gonfig to 0.7.1 (#865)</li> <li>Bump github.com/crazy-max/gohealthchecks to 0.4.1 (#866)</li> <li>Bump github.com/gregdel/pushover to 1.2.0 (#867)</li> <li>Bump go.etcd.io/bbolt to 1.3.7 (#781)</li> <li>Bump github.com/docker/distribution to 2.8.2+incompatible (#871)</li> <li>Bump github.com/opencontainers/runc to 1.1.5 (#834)</li> <li>Bump github.com/rs/zerolog to 1.29.1 (#777 #854)</li> <li>Bump github.com/panjf2000/ants/v2 to 2.7.5 (#846 #889)</li> <li>Bump github.com/jedib0t/go-pretty/v6 to 6.4.4 (#760 #803)</li> <li>Bump github.com/microcosm-cc/bluemonday to 1.0.24 (#780 #810 #876)</li> <li>Bump github.com/go-playground/validator/v10 to 10.14.10 (#778 #852 #896)</li> <li>Bump github.com/imdario/mergo to 0.3.16 (#830 #898)</li> <li>Bump google.golang.org/grpc to 1.52.0 (#762 #785 #826 #864)</li> <li>Bump google.golang.org/grpc/cmd/protoc-gen-go-grpc to 1.3.0 (#806)</li> <li>Bump google.golang.org/protobuf to 1.30.0 (#818)</li> <li>Bump golang.org/x/mod to 0.10.0 (#786 #808 #837)</li> <li>Bump golang.org/x/net to 0.7.0 (#793)</li> <li>Bump golang.org/x/sys to 0.8.0 (#784 #807 #857)</li> <li>Bump github.com/stretchr/testify to 1.8.4 (#801 #897)</li> </ul>"},{"location":"changelog/#4240-20221229","title":"4.24.0 (2022/12/29)","text":"<ul> <li>Entry metadata field (#749)</li> <li>Jitter watch option (#746)</li> <li>Allow customizing Signal notification message (#748)</li> </ul>"},{"location":"changelog/#4231-20221228","title":"4.23.1 (2022/12/28)","text":"<ul> <li>Fix release file extension (#743)</li> </ul>"},{"location":"changelog/#4230-20221228","title":"4.23.0 (2022/12/28)","text":"<ul> <li>Nomad provider (#722 #739 #742)</li> <li>Signal (REST API) notifications support (#650)</li> <li>Fix email notification message template (#740)</li> <li>Fix panics when parsing notification templates (#741)</li> <li>Fix test notification typo (#677)</li> <li>docs: Fix <code>sort_tags</code> (#655)</li> <li>docs: List valid log levels (#668)</li> <li>docs: Fix the issues URL (#697)</li> <li>docs: New blog posts from the community (#657)</li> <li>Go 1.19 (#701)</li> <li>Alpine Linux 3.17 (#735)</li> <li>Fix proto gen (#720)</li> <li>Enhance workflow (#706)</li> <li>Use <code>GITHUB_REF</code> when tag pushed for versioning (#707)</li> <li>Bump github.com/crazy-max/gonfig from 0.5.0 to 0.6.0 (#651)</li> <li>Bump github.com/containerd/containerd from 1.6.6 to 1.6.14 (#669 #719 #732)</li> <li>Bump github.com/rs/zerolog from 1.27.0 to 1.28.0 (#676)</li> <li>Bump github.com/AlecAivazis/survey/v2 from 2.3.5 to 2.3.6 (#686)</li> <li>Bump github.com/docker/go-units from 0.4.0 to 0.5.0 (#678)</li> <li>Bump github.com/tidwall/pretty from 1.2.0 to 1.2.1 (#698)</li> <li>Bump github.com/go-playground/validator/v10 from 10.11.0 to 10.11.1 (#699)</li> <li>Bump github.com/microcosm-cc/bluemonday from 1.0.19 to 1.0.21 (#695)</li> <li>Bump github.com/jedib0t/go-pretty/v6 from 6.3.5 to 6.4.3 (#694 #715 #724)</li> <li>Bump google.golang.org/protobuf from 1.28.0 to 1.28.1 (#661)</li> <li>Bump github.com/containers/image/v5 from 5.21.1 to 5.23.1 (#692 #716)</li> <li>Bump google.golang.org/grpc from 1.48.0 to 1.51.0 (#696 #721)</li> <li>Bump k8s.io/client-go from 0.24.3 to 0.25.4 (#689 #717)</li> <li>Bump github.com/pkg/profile from 1.6.0 to 1.7.0 (#705)</li> <li>Bump github.com/alecthomas/kong from 0.6.1 to 0.7.1 (#718)</li> <li>Bump github.com/eclipse/paho.mqtt.golang from 1.4.1 to 1.4.2 (#711)</li> <li>Bump github.com/panjf2000/ants/v2 from 2.5.0 to 2.7.1 (#709 #733)</li> <li>Bump github.com/stretchr/testify from 1.8.0 to 1.8.1 (#708)</li> <li>Bump github.com/opencontainers/image-spec from 1.1.0-rc1 to 1.1.0-rc2 (#702)</li> <li>Bump golang.org/x/mod to 0.7.0 (#736)</li> <li>Bump golang.org/x/sys to 0.3.0 (#737)</li> <li>Bump github.com/moby/buildkit to 0.10.6 (#738)</li> </ul>"},{"location":"changelog/#4220-20220717","title":"4.22.0 (2022/07/17)","text":"<ul> <li>Allow customizing the hub link (#648)</li> <li>Use OCI image url label to override hub link (#646)</li> <li>Tags sorting support (#645)</li> <li>Alpine Linux 3.16 (#647)</li> <li>Go 1.18 (#592)</li> <li>MkDocs Material 8.3.9 (#644)</li> <li>Explain roles required for rocketchat notification (#553)</li> <li>Bump github.com/AlecAivazis/survey/v2 from 2.3.2 to 2.3.5 (#585 #625)</li> <li>Bump github.com/alecthomas/kong from 0.3.0 to 0.6.1 (#549 #558 #576 #630)</li> <li>Bump github.com/containerd/containerd from 1.5.9 to 1.6.0 (#557)</li> <li>Bump github.com/containers/image/v5 from 5.19.0 to 5.21.1 (#552 #588 #603)</li> <li>Bump github.com/docker/docker from 20.10.12 to 20.10.3-0.20220414164044-61404de7df1a (#575)</li> <li>Bump github.com/eclipse/paho.mqtt.golang from 1.3.5 to 1.4.1 (#623)</li> <li>Bump github.com/go-playground/validator/v10 from 10.10.0 to 10.11.0 (#568 #602)</li> <li>Bump github.com/imdario/mergo from 0.3.12 to 0.3.13 (#617)</li> <li>Bump github.com/jedib0t/go-pretty/v6 from 6.2.5 to 6.3.5 (#555 #584 #595 #642)</li> <li>Bump github.com/microcosm-cc/bluemonday from 1.0.17 to 1.0.19 (#554 #636)</li> <li>Bump github.com/moby/buildkit from 0.9.3 to 0.10.1-0.20220712094726-874eef9b70db (#578 #590 #610 #643)</li> <li>Bump github.com/panjf2000/ants/v2 from 2.4.7 to 2.5.0 (#563 #611)</li> <li>Bump github.com/rs/zerolog from 1.26.1 to 1.27.0 (#626)</li> <li>Bump github.com/stretchr/testify from 1.7.1 to 1.8.0 (#635)</li> <li>Bump google.golang.org/grpc from 1.45.0 to 1.48.0 (#615 #639)</li> <li>Bump google.golang.org/protobuf from 1.27.1 to 1.28.0 (#582)</li> <li>Bump k8s.io/client-go from 0.22.5 to 0.24.3 (#561 #580 #604 #640)</li> </ul>"},{"location":"changelog/#4210-20220126","title":"4.21.0 (2022/01/26)","text":"<ul> <li>Add <code>image prune</code> command (#519)</li> <li>Fix matrix login scheme (#487)</li> <li>Move <code>syscall</code> to <code>golang.org/x/sys</code> (#525)</li> <li>Move from <code>io/ioutil</code> to <code>os</code> package (#524)</li> <li>Fix notif template in docs</li> <li>Enhance dockerfiles (#523)</li> <li>Add binary bake target (#517)</li> <li>MkDocs Material 8.1.8 (#520 #548)</li> <li>Alpine Linux 3.15 (#527)</li> <li>goreleaser-xx 1.2.5 (#539)</li> <li>Bump github.com/alecthomas/kong from 0.2.17 to 0.3.0 (#507 #537)</li> <li>Bump github.com/containerd/containerd from 1.5.5 to 1.5.8 (#494 #496 #509)</li> <li>Bump github.com/containers/image/v5 from 5.16.0 to 5.19.0 (#498 #536 #546)</li> <li>Bump github.com/docker/docker from 20.10.8+incompatible to 20.10.12+incompatible (#500 #510 #531)</li> <li>Bump github.com/go-playground/validator/v10 from 10.9.0 to 10.10.0 (#538)</li> <li>Bump github.com/jedib0t/go-pretty/v6 from 6.2.4 to 6.2.5 (#543)</li> <li>Bump github.com/microcosm-cc/bluemonday from 1.0.15 to 1.0.17 (#499 #535)</li> <li>Bump github.com/moby/buildkit from 0.9.0 to 0.9.3 (#495 #506 #512)</li> <li>Bump github.com/opencontainers/image-spec to v1.0.2-0.20211117181255-693428a734f5 (#513)</li> <li>Bump github.com/panjf2000/ants/v2 from 2.4.6 to 2.4.7 (#532)</li> <li>Bump github.com/rs/zerolog from 1.24.0 to 1.26.1 (#485 #502 #534)</li> <li>Bump google.golang.org/grpc from 1.40.0 to 1.44.0 (#492 #505 #529 #545)</li> <li>Bump google.golang.org/grpc/cmd/protoc-gen-go-grpc from 1.1.0 to 1.2.0 (#533)</li> <li>Bump k8s.io/client-go from 0.22.1 to 0.22.4 (#490 #511)</li> </ul>"},{"location":"changelog/#4201-20210906","title":"4.20.1 (2021/09/06)","text":"<ul> <li>Fix notification title (#483)</li> </ul>"},{"location":"changelog/#4200-20210905","title":"4.20.0 (2021/09/05)","text":"<ul> <li>Option to render fields (#480)</li> <li>Allow choosing status to be notified (#475)</li> <li>Enhance notif wording (#467)</li> <li>Wrong remaining time displayed (#469)</li> <li>Allow multi recipients for email notifier (#463)</li> <li>Provide mutable tags for Diun image (#462)</li> <li>Fix Dockerfile parser and add tests (#459)</li> <li>Add e2e tests (#471)</li> <li>Use args in kubernetes documentation example (#424)</li> <li>Fix j2 variable in docs (#422)</li> <li>Note to customize the hostname (#465)</li> <li>Go 1.17 (#458)</li> <li>Add <code>windows/arm64</code> artifact (#472)</li> <li>Add <code>linux/riscv64</code> artifact (#427)</li> <li>Alpine Linux 3.14 (#426)</li> <li>MkDocs Material 7.2.6 (#428 #482)</li> <li>Protoc 3.17.3 (#461)</li> <li>Bump github.com/rs/zerolog from 1.23.0 to 1.24.0 (#477)</li> <li>Bump github.com/crazy-max/gonfig from 0.4.0 to 0.5.0 (#474)</li> <li>Bump github.com/gregdel/pushover to 1.1.0 (#470)</li> <li>Bump github.com/streadway/amqp to 1.0.0 (#470)</li> <li>Bump github.com/containers/image/v5 from 5.13.2 to 5.16.0 (#460 #476)</li> <li>Bump k8s.io/client-go from 0.21.2 to 0.22.1 (#466)</li> <li>Bump github.com/docker/docker from 20.10.7 to 20.10.8 (#451)</li> <li>Bump github.com/moby/buildkit from 0.8.3 to 0.9.0 (#437)</li> <li>Bump github.com/containerd/containerd from 1.5.2 to 1.5.5 (#433 #440 #447)</li> <li>Bump github.com/microcosm-cc/bluemonday from 1.0.14 to 1.0.15 (#430)</li> <li>Bump github.com/go-playground/validator/v10 from 10.6.1 to 10.9.0 (#429 #445 #455)</li> <li>Bump github.com/jedib0t/go-pretty/v6 from 6.2.2 to 6.2.4 (#432)</li> <li>Bump google.golang.org/grpc from 1.38.0 to 1.40.0 (#421 #453 #456)</li> <li>Bump google.golang.org/protobuf from 1.26.0 to 1.27.1 (#420)</li> <li>Bump codecov/codecov-action from 1 to 2</li> </ul>"},{"location":"changelog/#4190-20210626","title":"4.19.0 (2021/06/26)","text":"<ul> <li>Allow customizing notification message (#415)</li> <li>Bump github.com/panjf2000/ants/v2 from 2.4.5 to 2.4.6 (#416)</li> <li>Bump k8s.io/client-go from 0.21.1 to 0.21.2 (#414)</li> <li>Bump github.com/microcosm-cc/bluemonday from 1.0.13 to 1.0.14 (#413)</li> <li>Bump github.com/containers/image/v5 from 5.13.1 to 5.13.2 (#412)</li> </ul>"},{"location":"changelog/#4180-20210618","title":"4.18.0 (2021/06/18)","text":"<ul> <li>Handle registry auth config (#411)</li> <li>Bump k8s.io/client-go from 0.20.6 to 0.21.1 (#381)</li> <li>Bump github.com/containers/image/v5 from 5.12.0 to 5.13.1 (#409)</li> <li>Avoid notification for unupdated image (#406)</li> <li>Use <code>openssl</code> pkg (#407)</li> <li>Bump github.com/rs/zerolog from 1.22.0 to 1.23.0 (#405)</li> <li>Bump google.golang.org/grpc from 1.37.0 to 1.38.0 (#389)</li> <li>Bump github.com/microcosm-cc/bluemonday from 1.0.9 to 1.0.13 (#403 #410)</li> <li>Bumps github.com/docker/docker from 20.10.6+incompatible to 20.10.7+incompatible (#397)</li> <li>Bump github.com/jedib0t/go-pretty/v6 from 6.2.1 to 6.2.2 (#388)</li> <li>Bump go.etcd.io/bbolt from 1.3.5 to 1.3.6 (#394)</li> <li>Bump github.com/eclipse/paho.mqtt.golang from 1.3.4 to 1.3.5 (#400)</li> <li>Bump github.com/alecthomas/kong from 0.2.16 to 0.2.17 (#401)</li> <li>Bump github.com/tidwall/pretty from 1.1.0 to 1.2.0 (#390 #402)</li> <li>Set <code>cacheonly</code> output for validators (#395)</li> <li>Define serve command (#393)</li> <li>Save raw manifest in db (#391)</li> </ul>"},{"location":"changelog/#4170-20210526","title":"4.17.0 (2021/05/26)","text":"<p> See Migration notes in the documentation before upgrading.</p> <ul> <li>Add CLI to interact with Diun through gRPC (#382)<ul> <li>Create <code>image</code> and <code>notif</code> proto services</li> <li>Implement proto definitions</li> <li>New commands <code>serve</code>, <code>image</code> and <code>notif</code></li> <li>Refactor command line usage doc</li> <li>Better CLI error handling</li> <li>Tools build constraint to manage tools deps through go modules</li> <li>Compile and validate protos through a dedicated Dockerfile and a bake target    </li> <li>Merge validate and build workflow</li> <li>Add upgrade notes</li> </ul> </li> <li>Bump github.com/eclipse/paho.mqtt.golang from 1.3.3 to 1.3.4 (#359)</li> <li>Bump github.com/panjf2000/ants/v2 from 2.4.4 to 2.4.5 (#380)</li> <li>Bump github.com/rs/zerolog from 1.21.0 to 1.22.0 (#379)</li> <li>Bump github.com/go-playground/validator/v10 from 10.5.0 to 10.6.1 (#377)</li> <li>MkDocs Materials 7.1.5 (#386)</li> <li>Add <code>NO_COLOR</code> support (#384)</li> <li>Bump github.com/pkg/profile from 1.5.0 to 1.6.0 (#363)</li> <li>Move to docker/metadata-action (#366)</li> <li>Bump github.com/containers/image/v5 from 5.11.1 to 5.12.0 (#360)</li> <li>Bump github.com/containerd/containerd from 1.5.0-beta.4 to 1.5.2 (#353 #361 #362 #383)</li> <li>Add blog posts (#355 #385)</li> <li>Bump github.com/moby/buildkit from 0.8.2 to 0.8.3 (#354)</li> </ul>"},{"location":"changelog/#4161-20210430","title":"4.16.1 (2021/04/30)","text":"<ul> <li>Fix Swarm Provider (#351)</li> </ul>"},{"location":"changelog/#4160-20210429","title":"4.16.0 (2021/04/29)","text":"<ul> <li>Dockerfile provider (#329)</li> <li>Note about <code>watch_repo</code> setting (#348)</li> <li>Contribute to doc (#347)</li> <li>Update docs for Podman support (#345)</li> <li>Optional profiler volume (#344)</li> </ul>"},{"location":"changelog/#4152-20210425","title":"4.15.2 (2021/04/25)","text":"<ul> <li>Make profiler optional (#341)</li> </ul>"},{"location":"changelog/#4151-20210425","title":"4.15.1 (2021/04/25)","text":"<ul> <li>Fix profiler path (#339)</li> </ul>"},{"location":"changelog/#4150-20210425","title":"4.15.0 (2021/04/25)","text":"<ul> <li>Add <code>darwin/arm64</code> artifact (#338)</li> <li>MkDocs Materials 7.1.3 (#337)</li> <li>Add profiler flag (#336)</li> <li>Handle digest based image reference (#335)</li> <li>Bump github.com/docker/docker from 20.10.5+incompatible to 20.10.6+incompatible (#324)</li> <li>Bump github.com/containers/image/v5 from 5.10.5 to 5.11.1 (#323 #330)</li> <li>Bump github.com/go-playground/validator/v10 from 10.4.1 to 10.5.0 (#319)</li> <li>Bump github.com/panjf2000/ants/v2 from 2.4.3 to 2.4.4 (#312)</li> <li>Bump github.com/rs/zerolog from 1.20.0 to 1.21.0 (#309)</li> <li>Bump github.com/microcosm-cc/bluemonday from 1.0.4 to 1.0.9 (#311 #321 #325 #333)</li> <li>Bump github.com/eclipse/paho.mqtt.golang from 1.3.2 to 1.3.3 (#316)</li> <li>Deploy docs on workflow dispatch or tag (#305)</li> </ul>"},{"location":"changelog/#4140-20210315","title":"4.14.0 (2021/03/15)","text":"<ul> <li>Bump k8s.io/client-go from 0.19.4 to 0.20.4 (#280)</li> <li>Docker client 20.10.5 (#303)</li> <li>Allow telegram chat IDs as file (#301)</li> <li>Go 1.16 (#302)</li> <li>Handle git ref for artifact target</li> <li>Bump github.com/imdario/mergo from 0.3.11 to 0.3.12 (#298)</li> <li>Bump github.com/crazy-max/gohealthchecks from 0.2.0 to 0.3.0 (#296)</li> <li>Bump github.com/alecthomas/kong from 0.2.15 to 0.2.16 (#295)</li> <li>Allow configuring scheme for MQTT broker (#292)</li> <li>Switch to goreleaser-xx (#291)</li> <li>Bump github.com/containers/image/v5 from 5.10.4 to 5.10.5 (#290)</li> </ul>"},{"location":"changelog/#4130-20210301","title":"4.13.0 (2021/03/01)","text":"<ul> <li>Missing token as secret setting for some notifiers (#289)</li> <li>Allow disabling log color output (#288)</li> <li>Bump github.com/containers/image/v5 from 5.10.1 to 5.10.4 (#271 #282 #284)</li> <li>Cleanup workflows (#281 #287)</li> <li>Do not check recipient details for Pushover (#277)</li> <li>MkDocs Materials 6.2.8 (#276)</li> <li>Fix markdown renderer (#275)</li> <li>Add message client for notifiers (#273)</li> </ul>"},{"location":"changelog/#4120-20210209","title":"4.12.0 (2021/02/09)","text":"<ul> <li>Use digest as comparison footprint (#269)</li> <li>Bump github.com/alecthomas/kong from 0.2.12 to 0.2.15 (#270)</li> <li>Bump github.com/eclipse/paho.mqtt.golang from 1.3.1 to 1.3.2 (#268)</li> <li>Bump github.com/containers/image/v5 from 5.9.0 to 5.10.1 (#265)</li> <li>Move to docker/bake-action (#266)</li> <li>Typo in documentation (#258)</li> <li>Log image validation</li> </ul>"},{"location":"changelog/#4110-20210104","title":"4.11.0 (2021/01/04)","text":"<ul> <li>Fix DB migration (#255)</li> <li>Add Pushover notification (#254)</li> <li>Avoid duplicated notifications with Kubernetes DaemonSet (#252)</li> <li>Make scheduler optional (#251)</li> <li>Bump github.com/eclipse/paho.mqtt.golang from 1.3.0 to 1.3.1 (#249)</li> <li>Handle exclusions as a distinct status (#248)</li> </ul>"},{"location":"changelog/#4100-20201226","title":"4.10.0 (2020/12/26)","text":"<ul> <li>Refactor CI and dev workflow with buildx bake (#247)<ul> <li>Upload artifacts</li> <li>Add <code>image-local</code> target</li> <li>Single job for artifacts and image</li> <li>Add <code>armv5</code> artifact</li> </ul> </li> <li>MQTT Reconnection Log Spam (#241)</li> <li>Add Docker + File providers user guide (#239)</li> <li>Bump github.com/alecthomas/kong from 0.2.11 to 0.2.12 (#231)</li> <li>Bump github.com/eclipse/paho.mqtt.golang from 1.2.0 to 1.3.0 (#235)</li> <li>Bump github.com/containers/image/v5 from 5.8.1 to 5.9.0 (#236)</li> <li>Bump gopkg.in/yaml.v2 from 2.3.0 to 2.4.0 (#228)</li> <li>Bump github.com/containers/image/v5 from 5.8.0 to 5.8.1 (#226)</li> </ul>"},{"location":"changelog/#490-20201116","title":"4.9.0 (2020/11/16)","text":"<ul> <li>Fix duplicated notifications</li> <li>Remove support for <code>freebsd/*</code> (moby/moby#38818)</li> <li>Add support for <code>linux/ppc64le</code> and <code>linux/s390x</code> (binary)</li> <li>Bump k8s.io/client-go from 0.19.3 to 0.19.4 (#224)</li> <li>Bump github.com/containers/image/v5 to 5.8.0</li> </ul>"},{"location":"changelog/#481-20201114","title":"4.8.1 (2020/11/14)","text":"<ul> <li>Fix registry timeout context (#221)</li> <li>Image closer not required while fetching tags</li> </ul>"},{"location":"changelog/#480-20201113","title":"4.8.0 (2020/11/13)","text":"<ul> <li>Go 1.15 (#218)</li> <li>Remove <code>linux/s390x</code> platform support (for now)</li> <li>Check digest from HEAD request (#217)</li> <li>Add FAQ note about Docker Hub rate limits</li> <li>Compare digest as watch setting</li> <li>Optimize build time</li> <li>Add hub link for GitHub Container Registry (#211)</li> <li>Update deps</li> </ul>"},{"location":"changelog/#470-20201102","title":"4.7.0 (2020/11/02)","text":"<ul> <li>Add MQTT notification (#192)</li> <li>Docker image also available on GitHub Container Registry</li> <li>Use zoneinfo from Go (#202)</li> <li>Remove <code>--timezone</code> flag</li> <li>Use Docker meta action to handle tags and labels</li> <li>Update deps</li> </ul>"},{"location":"changelog/#461-20201022","title":"4.6.1 (2020/10/22)","text":"<ul> <li>Typos in documentation</li> <li>Bump docker/login-action from v1.4.1 to v1.6.0 (#198)</li> <li>Bump k8s.io/client-go from 0.19.2 to 0.19.3 (#199)</li> <li>Bump codecov/codecov-action from v1.0.13 to v1.0.14 (#195)</li> <li>Bump github.com/go-playground/validator/v10 from 10.4.0 to 10.4.1 (#197)</li> <li>Bump github.com/panjf2000/ants/v2 from 2.4.2 to 2.4.3 (#196)</li> </ul>"},{"location":"changelog/#460-20201013","title":"4.6.0 (2020/10/13)","text":"<ul> <li>Add support for Healthchecks to monitor Diun watcher (#78)</li> <li>Add option to mention specific users or roles for Discord notifier (#188)</li> <li>Update docker install documentation</li> <li>Add \"Too many requests to registry\" section in FAQ (#168)</li> <li>Update deps</li> <li>Switch to Docker actions</li> </ul>"},{"location":"changelog/#450-20200829","title":"4.5.0 (2020/08/29)","text":"<ul> <li>Allow setting the hostname sent to the SMTP server with the HELO command for mail notification (#165)</li> <li>Fix Telegram notification error (#162)</li> </ul>"},{"location":"changelog/#441-20200820","title":"4.4.1 (2020/08/20)","text":"<ul> <li>Allow using <code>--test-notif</code> without providers and DB connection (#157 #150)</li> <li>Update deps</li> </ul>"},{"location":"changelog/#440-20200808","title":"4.4.0 (2020/08/08)","text":"<ul> <li>Allow customizing message type for Matrix notifications (#143)</li> </ul>"},{"location":"changelog/#431-20200730","title":"4.3.1 (2020/07/30)","text":"<ul> <li>Hostname not taken into account for Matrix notifications</li> </ul>"},{"location":"changelog/#430-20200729","title":"4.3.0 (2020/07/29)","text":"<ul> <li>Add Matrix notification (#124)</li> </ul>"},{"location":"changelog/#420-20200716","title":"4.2.0 (2020/07/16)","text":"<ul> <li>Seek configuration file from default places (#107)</li> <li>Switch to gonfig</li> <li>Update deps</li> </ul>"},{"location":"changelog/#411-20200626","title":"4.1.1 (2020/06/26)","text":"<ul> <li>Small typo</li> </ul>"},{"location":"changelog/#410-20200626","title":"4.1.0 (2020/06/26)","text":"<ul> <li>Discord notifications (#110 #111)</li> <li>Update migration notes (#107)</li> <li>Logging when configuration file or <code>DIUN_</code> env vars not found (#107)</li> <li>Bump github.com/containers/image/v5 from 5.4.4 to 5.5.1 (#96)</li> </ul>"},{"location":"changelog/#400-20200622","title":"4.0.0 (2020/06/22)","text":"<p> See Migration notes in the documentation for breaking changes.</p> <ul> <li>Display hostname in notifications (#102)</li> <li>Automatically determine registry options based on image name (#103)</li> <li>Docs website with mkdocs (#99)</li> <li>Skip dangling images (#98)</li> <li>More explicit message if manifest not found (#94)</li> <li>Add swarm example</li> <li>Update doc for file and Swarm providers</li> <li>Add Kubernetes provider (#25)</li> <li>Update Teams notification screenshot (#93)</li> <li>Send message as markdown for Gotify and Telegram notifiers</li> <li>Add link to respective hub (#40)</li> <li>Configuration transposed into environment variables (#82)</li> <li>Configuration file not required anymore</li> <li><code>DIUN_DB</code> env var renamed <code>DIUN_DB_PATH</code></li> <li>Only accept duration as timeout value (<code>10</code> becomes <code>10s</code>)</li> <li>Enhanced documentation (#83)</li> <li>Add note about test notifications (#79)</li> <li>Improve configuration validation</li> <li>Fix telegram init</li> <li>All fields in configuration are now camelCased</li> <li>Docker API version negotiation (#29)</li> <li>Add Mattermost compatibility via Slack webhooks (#80)</li> <li>Update deps</li> </ul>"},{"location":"changelog/#300-20200527","title":"3.0.0 (2020/05/27)","text":"<p> See Migration notes in the documentation for breaking changes.</p> <ul> <li>Add script notification (#53)</li> <li>Add Teams notification (#72)</li> <li>Add <code>--test-notif</code> flag (#23)</li> <li>Allow only one Docker and Swarm provider</li> <li>Remove \"enable\" setting for notifiers</li> <li>Logging when no image is found</li> <li>Add Amqp notification client (#63)</li> <li>Fix default log level</li> <li>Move static to file provider (#71)</li> <li>Reload config on change for file provider (#16)</li> <li>Switch to kong command-line parser (#66)</li> <li>Enhanced Dockerfile</li> <li>Review of platform detection (#57)</li> <li>Leave default image platform empty for file provider (see FAQ doc)</li> <li>Handle platform variant</li> <li>Add database migration process</li> <li>Switch to Open Container Specification labels as label-schema.org ones are deprecated</li> <li>Remove unneeded <code>diun.os</code> and <code>diun.arch</code> docker labels</li> <li>Add upgrade notes</li> <li>Update deps</li> </ul>"},{"location":"changelog/#261-20200326","title":"2.6.1 (2020/03/26)","text":"<ul> <li>Downgrade containers/image to 5.2.1 (#54)</li> </ul>"},{"location":"changelog/#260-20200326","title":"2.6.0 (2020/03/26)","text":"<ul> <li>Fix service image inspection (#52)</li> <li>Docker client v19.03.8</li> <li>Update deps</li> </ul>"},{"location":"changelog/#250-20200301","title":"2.5.0 (2020/03/01)","text":"<ul> <li>Add Rocket.Chat notifier (#44)</li> </ul>"},{"location":"changelog/#240-20200217","title":"2.4.0 (2020/02/17)","text":"<ul> <li>Add Gotify notification client (#36)</li> <li>Bump containers/image v5 (#35) </li> </ul>"},{"location":"changelog/#230-20200128","title":"2.3.0 (2020/01/28)","text":"<ul> <li>Add Telegram notifier (#30)</li> <li>Docker client struct options</li> <li>Move registry client to a dedicated package</li> </ul>"},{"location":"changelog/#221-20200107","title":"2.2.1 (2020/01/07)","text":"<ul> <li>Set user agent for Docker registry client</li> <li>Update deps</li> </ul>"},{"location":"changelog/#220-20191222","title":"2.2.0 (2019/12/22)","text":"<ul> <li>Add option to skip notification at the very first analysis of an image (#10)</li> <li>Skip analysis of locally built image</li> </ul>"},{"location":"changelog/#210-20191217","title":"2.1.0 (2019/12/17)","text":"<ul> <li>Add Slack notifier (#8)</li> </ul>"},{"location":"changelog/#200-20191214","title":"2.0.0 (2019/12/14)","text":"<p> See Migration notes in the documentation for breaking changes.</p> <ul> <li>Include provider in notifications</li> <li>Add providers documentation</li> <li>Move image validation and improve job execution</li> <li>Add Swarm provider</li> <li>Add fields to load sensitive values from file (#7)</li> <li>Add Docker provider (#3)</li> <li>Docker client v19.03.5</li> <li>Move <code>image</code> field to providers layer and rename it <code>static</code></li> <li>Update deps</li> <li>Go 1.13.5</li> <li>Seconds field optional for schedule</li> </ul>"},{"location":"changelog/#141-20191020","title":"1.4.1 (2019/10/20)","text":"<ul> <li>Update deps</li> <li>Fix Docker labels</li> </ul>"},{"location":"changelog/#140-20191001","title":"1.4.0 (2019/10/01)","text":"<ul> <li>Multi-platform Docker image</li> <li>Switch to GitHub Actions</li> <li>Stop publishing Docker image on Quay</li> <li>Go 1.12.10</li> <li>Use GOPROXY</li> </ul>"},{"location":"changelog/#130-20190822","title":"1.3.0 (2019/08/22)","text":"<ul> <li>Add Linux service doc and sample</li> <li>Move documentation</li> <li>Fix go mod</li> <li>Remove <code>--docker</code> flag</li> <li>Allow overriding database path through <code>DIUN_DB</code> env var</li> </ul>"},{"location":"changelog/#120-20190818","title":"1.2.0 (2019/08/18)","text":"<ul> <li>Update deps</li> <li>Display containers/image logs</li> <li>Fix registry options not setted (#5)</li> </ul>"},{"location":"changelog/#110-20190724","title":"1.1.0 (2019/07/24)","text":"<ul> <li>Update deps</li> </ul>"},{"location":"changelog/#102-20190701","title":"1.0.2 (2019/07/01)","text":"<ul> <li>Worker pool can be full while retrieving tags</li> </ul>"},{"location":"changelog/#101-20190701","title":"1.0.1 (2019/07/01)","text":"<ul> <li>Fix runtime error</li> </ul>"},{"location":"changelog/#100-20190701","title":"1.0.0 (2019/07/01)","text":"<p> See Migration notes in the documentation for breaking changes.</p> <ul> <li>Always run on startup. Flag <code>--run-startup</code> removed.</li> <li>Display next execution time</li> <li>Use v3 robfig/cron</li> <li>Move <code>Os</code> and <code>Arch</code> filters to image</li> <li>Retrieve all tags by default</li> <li>Review config file structure</li> <li>Improve worker pool</li> </ul>"},{"location":"changelog/#050-20190609","title":"0.5.0 (2019/06/09)","text":"<ul> <li>Add worker pool to parallelize analyses</li> </ul>"},{"location":"changelog/#041-20190608","title":"0.4.1 (2019/06/08)","text":"<ul> <li>Filter tags before return them</li> </ul>"},{"location":"changelog/#040-20190608","title":"0.4.0 (2019/06/08)","text":"<ul> <li>Add option to set the maximum number of tags to watch for an item if <code>watch_repo</code> is enabled</li> </ul>"},{"location":"changelog/#032-20190608","title":"0.3.2 (2019/06/08)","text":"<ul> <li>Fix registry client context</li> </ul>"},{"location":"changelog/#031-20190608","title":"0.3.1 (2019/06/08)","text":"<ul> <li>Fix email template</li> <li>Add flag to log caller</li> </ul>"},{"location":"changelog/#030-20190608","title":"0.3.0 (2019/06/08)","text":"<ul> <li>Allow overriding os and architecture when watching</li> <li>Move <code>insecure_tls</code> and <code>timeout</code> options to registry option</li> <li>Rename Bolt bucket</li> <li>Change default schedule</li> <li>Review registry client</li> </ul>"},{"location":"changelog/#020-20190605","title":"0.2.0 (2019/06/05)","text":"<ul> <li>Don't skip repo analysis if default tag not found</li> <li>Docker engine 18.09.6</li> </ul>"},{"location":"changelog/#011-20190604","title":"0.1.1 (2019/06/04)","text":"<ul> <li>Increase default timeout</li> <li>Fix <code>data</code> volume mount</li> </ul>"},{"location":"changelog/#010-20190604","title":"0.1.0 (2019/06/04)","text":"<ul> <li>Initial version</li> </ul>"},{"location":"contributing/","title":"Contributing","text":"<p>Hi there! I'm thrilled that you'd like to contribute to this project. Your help is essential for keeping it great.</p> <p>Contributions to this project are released to the public under the project's open source license.</p>"},{"location":"contributing/#submitting-a-pull-request","title":"Submitting a pull request","text":"<ol> <li>Fork and clone the repository</li> <li>Configure and install the dependencies: <code>go mod download</code></li> <li>Create a new branch: <code>git checkout -b my-branch-name</code></li> <li>Make your changes</li> <li>Validate: <code>docker buildx bake validate</code></li> <li>Test your code: <code>docker buildx bake test</code></li> <li>Build the project: <code>docker buildx bake artifact-all image-all</code></li> <li>Push to your fork and submit a pull request</li> <li>Pat your self on the back and wait for your pull request to be reviewed and merged.</li> </ol> <p>Here are a few things you can do that will increase the likelihood of your pull request being accepted:</p> <ul> <li>Make sure the <code>README.md</code> and any other relevant documentation are kept up-to-date.</li> <li>I try to follow SemVer v2.0.0. Randomly breaking public APIs is not an option.</li> <li>Keep your change as focused as possible. If there are multiple changes you would like to make that are not dependent upon each other, consider submitting them as separate pull requests.</li> <li>Write a good commit message.</li> </ul>"},{"location":"contributing/#documentation","title":"Documentation","text":"<p>If you want to contribute to the documentation you can test its rendering locally with the following commands:</p> <pre><code># Build mkdocs image\ndocker build -t mkdocs -f ./hack/docs.Dockerfile --target base .\n# Run mkdocs image and watch for changes\ndocker run --rm -it -p 8000:8000 -v $(pwd):/docs mkdocs\n# Open http://localhost:8000 on your browser\n</code></pre>"},{"location":"contributing/#resources","title":"Resources","text":"<ul> <li>How to Contribute to Open Source</li> <li>Using Pull Requests</li> <li>GitHub Help</li> </ul>"},{"location":"donate/","title":"Donate","text":"<p>Diun  is free and open source and always will be.</p> <p>All kinds of contributions are welcome! The most basic way to show your support is to star the project, or to raise issues.</p> <p>You can also support this project by becoming a sponsor on GitHub or by making a Paypal donation to ensure this journey continues indefinitely!</p>"},{"location":"faq/","title":"FAQ","text":""},{"location":"faq/#timezone","title":"Timezone","text":"<p>By default, all interpretation and scheduling is done with your local timezone (<code>TZ</code> environment variable).</p> <p>Cron schedule may also override the timezone to be interpreted in by providing an additional space-separated field at the beginning of the cron spec, of the form <code>CRON_TZ=&lt;timezone&gt;</code>:</p> <pre><code>watch:\n  schedule: \"CRON_TZ=Asia/Tokyo 0 */6 * * *\"\n</code></pre>"},{"location":"faq/#test-notifications","title":"Test notifications","text":"<p>Through the command line with:</p> <pre><code>diun notif test\n</code></pre> <p>Or within a container:</p> <pre><code>docker compose exec diun diun notif test\n</code></pre>"},{"location":"faq/#customize-the-hostname","title":"Customize the hostname","text":"<p>The hostname that appears in your notifications is the one associated with the container if you use the Diun image with <code>docker run</code> or <code>docker compose up -d</code>. By default, it's a random string like <code>d2219b854598</code>. To change it:</p> <pre><code>$ docker run --hostname \"diun\" ...\n</code></pre> <p>Or if you use Docker Compose:</p> <pre><code>services:\n  diun:\n    image: crazymax/diun:latest\n    hostname: diun\n</code></pre>"},{"location":"faq/#notification-template","title":"Notification template","text":"<p>The title and body of a notification message can be customized for each notifier through <code>templateTitle</code> and <code>templateBody</code> fields except for those rendering JSON or Env like Amqp, MQTT, Script and Webhook.</p> <p>Templating is supported with the following fields:</p> Key Description <code>.Meta.ID</code> App ID: <code>diun</code> <code>.Meta.Name</code> App Name: <code>Diun</code> <code>.Meta.Desc</code> App description: <code>Docker image update notifier</code> <code>.Meta.URL</code> App repo URL: <code>https://github.com/crazy-max/diun</code> <code>.Meta.Logo</code> App logo URL: <code>https://raw.githubusercontent.com/crazy-max/diun/master/.res/diun.png</code> <code>.Meta.Author</code> App author: <code>CrazyMax</code> <code>.Meta.Version</code> App version: <code>v4.19.0</code> <code>.Meta.UserAgent</code> App user-agent used to talk with registries: <code>diun/4.19.0 go/1.16 Linux</code> <code>.Meta.Hostname</code> Hostname <code>.Entry.Status</code> Entry status. Can be <code>new</code>, <code>update</code>, <code>unchange</code>, <code>skip</code> or <code>error</code> <code>.Entry.Provider</code> Provider used <code>.Entry.Image</code> Docker image name. e.g. <code>docker.io/crazymax/diun:latest</code> <code>.Entry.Image.Domain</code> Docker image domain. e.g. <code>docker.io</code> <code>.Entry.Image.Path</code> Docker image path. e.g. <code>crazymax/diun</code> <code>.Entry.Image.Tag</code> Docker image tag. e.g. <code>latest</code> <code>.Entry.Image.Digest</code> Docker image digest <code>.Entry.Image.HubLink</code> Docker image hub link (if available). e.g. <code>https://hub.docker.com/r/crazymax/diun</code> <code>.Entry.Manifest.Name</code> Manifest name. e.g. <code>docker.io/crazymax/diun</code> <code>.Entry.Manifest.Tag</code> Manifest tag. e.g. <code>latest</code> <code>.Entry.Manifest.MIMEType</code> Manifest MIME type. e.g. <code>application/vnd.docker.distribution.manifest.list.v2+json</code> <code>.Entry.Manifest.Digest</code> Manifest digest <code>.Entry.Manifest.Created</code> Manifest created date. e.g. <code>2021-06-20T12:23:56Z</code> <code>.Entry.Manifest.DockerVersion</code> Version of Docker that was used to build the image. e.g. <code>20.10.7</code> <code>.Entry.Manifest.Labels</code> Image labels <code>.Entry.Manifest.Layers</code> Image layers <code>.Entry.Manifest.Platform</code> Platform that the image is runs on. e.g. <code>linux/amd64</code> <code>.Entry.Metadata</code> Key-value pair of image metadata specific to each provider"},{"location":"faq/#authentication-against-the-registry","title":"Authentication against the registry","text":"<p>You can authenticate against the registry through the <code>regopts</code> settings or you can mount your docker config file <code>$HOME/.docker/config.json</code> if you are already connected to the registry with <code>docker login</code>:</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    container_name: diun\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"/root/.docker/config.json:/root/.docker/config.json:ro\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\"\n      - \"DIUN_PROVIDERS_DOCKER=true\"\n      - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\"\n    restart: always\n</code></pre>"},{"location":"faq/#field-dockerswarm-uses-unsupported-type-invalid","title":"field docker|swarm uses unsupported type: invalid","text":"<p>If you have the error <code>failed to decode configuration from file: field docker uses unsupported type: invalid</code> that's because your <code>docker</code>, <code>swarm</code> or <code>kubernetes</code> provider is not initialized in your configuration:</p> <p>Failure</p> <pre><code>providers:\n  docker:\n</code></pre> <p>should be:</p> <p>Success</p> <pre><code>providers:\n  docker: {}\n</code></pre>"},{"location":"faq/#no-image-found-in-manifest-list-for-architecture-variant-os","title":"No image found in manifest list for architecture, variant, OS","text":"<p>If you encounter this kind of warning, you are probably using the file provider for an image with an erroneous or empty platform. If the platform is not filled in, it will be deduced automatically from the information of your operating system on which Diun is running.</p> <p>In the example below, Diun is running (<code>diun_x.x.x_windows_i386.zip</code>) on Windows 10 and tries to analyze the <code>crazymax/cloudflared</code> image with the detected platform (<code>windows/386)</code>:</p> <pre><code>- name: crazymax/cloudflared:2020.2.1\n</code></pre> <p>But this platform is not supported by this image as you can see on DockerHub:</p> <p>Warning</p> <p><code>Fri, 27 Mar 2020 01:20:03 UTC WRN Cannot get remote manifest error=\"Cannot create image closer: Error choosing image instance: no image found in manifest list for architecture 386, variant \\\"\\\", OS windows\" image=docker.io/image=crazymax/cloudflared:2020.2.1 provider=file</code></p> <p>You have to force the platform for this image if you are not on a supported platform:</p> <pre><code>- name: crazymax/cloudflared:2020.2.1\n  platform:\n    os: linux\n    arch: amd64\n</code></pre> <p>Success</p> <p><code>Fri, 27 Mar 2020 01:24:33 UTC INF New image found image=docker.io/crazymax/cloudflared:2020.2.1 provider=file</code></p>"},{"location":"faq/#too-many-requests-to-registry","title":"Too many requests to registry","text":"<p>The error <code>Cannot create image closer: too many requests to registry</code> is returned when the HTTP status code returned by the registry is 429.</p> <p>This can happen on the DockerHub registry because of the rate-limited anonymous pulls.</p> <p>To solve this you must first be authenticated against the registry through the <code>regopts</code> settings: </p> <pre><code>regopts:\n  - name: \"docker.io\"\n    selector: image\n    username: foo\n    password: bar\n</code></pre> <p>If this is not enough, tweak the <code>schedule</code> setting with something like <code>0 */6 * * *</code> (every 6 hours).</p>"},{"location":"faq/#docker-hub-rate-limits","title":"Docker Hub rate limits","text":"<p>Docker is now enforcing Docker Hub pull rate limits. This means you can make 100 pull image requests per six hours for anonymous usage, and 200 pull image requests per six hours for free Docker accounts. But this rate limit is not necessarily an indicator on the number of times an image has actually been downloaded. In fact, their pulls counter/metric is actually a representation of the number of times a manifest for a particular image has been retrieved.</p> <p>As you probably know, Diun downloads the manifest of an image from its registry through a <code>GET</code> request to be able to retrieve its inside metadata. Fortunately Diun doesn't perform a <code>GET</code> request at each scan but only when an image has been updated or added on the registry. This allows us not to exceed this rate limit in our situation, but it also strongly depends on the number of images you scan. To increase your pull rate limits you can upgrade your account to a Docker Pro or Team subscription and authenticate against the registry through the <code>regopts</code> settings: </p> <pre><code>regopts:\n  - name: \"docker.io\"\n    selector: image\n    username: foo\n    password: bar\n</code></pre> <p>Or you can tweak the <code>schedule</code> setting with something like <code>0 */6 * * *</code> (every 6 hours).</p> <p>Warning</p> <p>Also be careful with the <code>watch_repo</code> setting as it will fetch manifest for ALL tags available for the image.</p>"},{"location":"faq/#tags-sorting-when-using-watch_repo","title":"Tags sorting when using <code>watch_repo</code>","text":"<p>When you use the <code>watch_repo</code> setting, Diun will fetch all tags available for the image. Depending on the registry, order of the tags list can change.</p> <p>You can use the <code>sort_tags</code> setting available for each provider to use a specific sorting method for the tags list.</p> <ul> <li><code>default</code>: do not sort and use the expected tags list from the registry</li> <li><code>reverse</code>: reverse order for the tags list from the registry</li> <li><code>lexicographical</code>: sort the tags list lexicographically</li> <li><code>semver</code>: sort the tags list using semantic versioning</li> </ul> <p>Given the following list of tags received from the registry:</p> <pre><code>[\n  \"0.1.0\",\n  \"0.4.0\",\n  \"3.0.0-beta.1\",\n  \"3.0.0-beta.4\",\n  \"4\",\n  \"4.0.0\",\n  \"4.0.0-beta.1\",\n  \"4.1.0\",\n  \"4.1.1\",\n  \"4.10.0\",\n  \"4.11.0\",\n  \"4.20\",\n  \"4.20.0\",\n  \"4.20.1\",\n  \"4.3.0\",\n  \"4.3.1\",\n  \"4.9.0\",\n  \"edge\",\n  \"latest\"\n]\n</code></pre> <p>Here is the result for <code>reverse</code>:</p> <pre><code>[\n  \"latest\",\n  \"edge\",\n  \"4.9.0\",\n  \"4.3.1\",\n  \"4.3.0\",\n  \"4.20.1\",\n  \"4.20.0\",\n  \"4.20\",\n  \"4.11.0\",\n  \"4.10.0\",\n  \"4.1.1\",\n  \"4.1.0\",\n  \"4.0.0-beta.1\",\n  \"4.0.0\",\n  \"4\",\n  \"3.0.0-beta.4\",\n  \"3.0.0-beta.1\",\n  \"0.4.0\",\n  \"0.1.0\"\n]\n</code></pre> <p>And for <code>semver</code>:</p> <pre><code>[\n  \"4.20.1\",\n  \"4.20.0\",\n  \"4.20\",\n  \"4.11.0\",\n  \"4.10.0\",\n  \"4.9.0\",\n  \"4.3.1\",\n  \"4.3.0\",\n  \"4.1.1\",\n  \"4.1.0\",\n  \"4.0.0\",\n  \"4\",\n  \"4.0.0-beta.1\",\n  \"3.0.0-beta.4\",\n  \"3.0.0-beta.1\",\n  \"0.4.0\",\n  \"0.1.0\",\n  \"edge\",\n  \"latest\"\n]\n</code></pre>"},{"location":"faq/#custom-ca-certificates-for-notification-endpoints","title":"Custom CA certificates for notification endpoints","text":"<p>If your notification endpoint (e.g. Gotify, Ntfy, Telegram, Webhook, etc.) is using a self-signed certificate or a certificate issued by a private CA, you can provide the CA certificate to Diun through the <code>tlsCaCertFiles</code> setting:</p> <pre><code>notif:\n  gotify:\n    endpoint: https://gotify.foo.com\n    token: Token123456\n    tlsCaCertFiles:\n      - /certs/ca-gotify.crt\n</code></pre> <p>Then mount the certificate file in the container:</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    container_name: diun\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"/etc/ssl/certs/ca-gotify.crt:/certs/ca-gotify.crt:ro\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\"\n      - \"DIUN_PROVIDERS_DOCKER=true\"\n      - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\"\n    restart: always\n</code></pre>"},{"location":"faq/#profiling","title":"Profiling","text":"<p>Diun provides a simple way to manage runtime/pprof profiling through the <code>--profiler-path</code> and <code>--profiler</code> flags with <code>serve</code> command:</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    container_name: diun\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"./profiler:/profiler\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"LOG_LEVEL=info\"\n      - \"PROFILER_PATH=/profiler\"\n      - \"PROFILER=mem\"\n      - \"DIUN_PROVIDERS_DOCKER=true\"\n    restart: always\n</code></pre> <p>The following profilers are available:</p> <ul> <li><code>cpu</code> enables cpu profiling</li> <li><code>mem</code> enables memory profiling</li> <li><code>alloc</code> enables memory profiling and changes which type of memory to profile allocations</li> <li><code>heap</code> enables memory profiling and changes which type of memory profiling to profile the heap</li> <li><code>routines</code> enables goroutine profiling</li> <li><code>mutex</code> enables mutex profiling</li> <li><code>threads</code> enables thread creation profiling</li> <li><code>block</code> enables block (contention) profiling</li> </ul>"},{"location":"faq/#image-with-digest-and-imagetagdigest-format","title":"Image with digest and <code>image:tag@digest</code> format","text":"<p>Analysis of an image with a digest but without tag will be done using <code>latest</code> as a tag which could lead to false positives.</p> <p>For example <code>crazymax/diun@sha256:fa80af32a7c61128ffda667344547805b3c5e7721ecbbafd70e35bb7bb7c989f</code> is referring to <code>crazymax/diun:4.24.0</code> tag, so it's not correct to assume that we want to analyze <code>crazymax/diun:latest</code>.</p> <p>You can still pin an image to a specific digest and analyze the image if the tag is specified using the <code>image:tag@digest</code> format. Taking the previous example if we specify <code>crazymax/diun:4.24.0@sha256:fa80af32a7c61128ffda667344547805b3c5e7721ecbbafd70e35bb7bb7c989f</code>, then <code>crazymax/diun:4.24.0</code> will be analyzed.</p>"},{"location":"faq/#secrets-loaded-from-files-and-trailing-newlines","title":"Secrets loaded from files and trailing newlines","text":"<p>When Diun reads a secret from a file (e.g. Docker or Kubernetes secrets), the file content is used exactly as-is, including any trailing newline characters.</p> <p>This is intentional.</p> <p>A secret file is treated as an opaque value, not as a line of text. Automatically trimming or normalizing file content would silently modify the secret and could cause authentication or integration issues. Diun therefore does not attempt to guess whether a trailing newline was added intentionally or by tooling.</p> <p>This behavior aligns with common secret-management systems (such as Kubernetes and Vault), which model secrets as arbitrary data rather than text strings.</p> <p>If a trailing newline is not desired, ensure the file is created without one, for example:</p> <pre><code>printf '%s' 'mysecret' &gt; secret.txt\n</code></pre> <p>Any future trimming or text-normalization behavior would be introduced explicitly and opt-in.</p>"},{"location":"reporting-issue/","title":"Reporting an issue","text":""},{"location":"reporting-issue/#before-submitting-an-issue","title":"Before submitting an issue","text":"<p>First, be a respectful.</p> <p>Please do a search in open issues to see if the issue or feature request has already been filed and read the FAQ page first.</p> <p>If you find your issue already exists, make relevant comments and add your reaction. Use a reaction in place of a \"+1\" comment.</p> <p> - upvote</p> <p> - downvote</p> <p>If you cannot find an existing issue that describes your bug or feature, submit an issue using the guidelines below.</p>"},{"location":"reporting-issue/#writing-good-bug-reports-and-feature-requests","title":"Writing good bug reports and feature requests","text":"<p>File a single issue per problem and feature request.</p> <ul> <li>Do not enumerate multiple bugs or feature requests in the same issue.</li> <li>Do not add your issue as a comment to an existing issue unless it's for the identical input. Many issues look similar, but have different causes.</li> </ul> <p>The more information you can provide, the more likely someone will be successful reproducing the issue and finding a fix.</p> <p>You are now ready to create a new issue!</p>"},{"location":"reporting-issue/#closure-policy","title":"Closure policy","text":"<ul> <li>Issues that don't have the information requested above (when applicable) will be closed immediately and the poster directed to the support guidelines.</li> <li>Issues that go a week without a response from original poster are subject to closure at our discretion.</li> </ul>"},{"location":"config/","title":"Configuration","text":""},{"location":"config/#overview","title":"Overview","text":"<p>There are two different ways to define configuration in Diun:</p> <ul> <li>In a configuration file</li> <li>As environment variables</li> </ul> <p>These ways are evaluated in the order listed above.</p> <p>If no value was provided for a given option, a default value applies. Moreover, if an option has sub-options, and any of these sub-options is not specified, a default value will apply as well.</p> <p>For example, the <code>DIUN_PROVIDERS_DOCKER</code> environment variable is enough by itself to enable the docker provider, even though sub-options like <code>DIUN_PROVIDERS_DOCKER_ENDPOINT</code> exist. Once positioned, this option sets (and resets) all the default values of the sub-options of <code>DIUN_PROVIDERS_DOCKER</code>.</p>"},{"location":"config/#configuration-file","title":"Configuration file","text":"<p>At startup, Diun searches for a file named <code>diun.yml</code> (or <code>diun.yaml</code>) in:</p> <ul> <li><code>/etc/diun/</code></li> <li><code>$XDG_CONFIG_HOME/</code></li> <li><code>$HOME/.config/</code></li> <li><code>.</code> (the working directory)</li> </ul> <p>You can override this using the <code>--config</code> flag or <code>CONFIG</code> env var with <code>serve</code> command.</p> diun.yml <pre><code>db:\n  path: diun.db\n\nwatch:\n  workers: 10\n  schedule: \"0 */6 * * *\"\n  jitter: 30s\n  firstCheckNotif: false\n  runOnStartup: true\n\ndefaults:\n  watchRepo: false\n  notifyOn:\n    - new\n    - update\n  sortTags: reverse\n\nnotif:\n  amqp:\n    host: localhost\n    port: 5672\n    username: guest\n    password: guest\n    queue: queue\n  gotify:\n    endpoint: http://gotify.foo.com\n    token: Token123456\n    priority: 1\n    timeout: 10s\n  mail:\n    host: localhost\n    port: 25\n    ssl: false\n    insecureSkipVerify: false\n    from: diun@example.com\n    to:\n      - webmaster@example.com\n      - me@example.com\n  ntfy:\n    endpoint: https://ntfy.sh\n    topic: diun-acce65a0-b777-46f9-9a11-58c67d1579c4\n    priority: 3\n    timeout: 5s\n  rocketchat:\n    endpoint: http://rocket.foo.com:3000\n    channel: \"#general\"\n    userID: abcdEFGH012345678\n    token: Token123456\n    timeout: 10s\n  script:\n      cmd: \"myprogram\"\n      args:\n        - \"--anarg\"\n        - \"another\"\n  slack:\n    webhookURL: https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij\n  teams:\n    webhookURL: https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij\n  telegram:\n    token: aabbccdd:11223344\n    chatIDs:\n      - 123456789\n      - 987654321\n  webhook:\n    endpoint: http://webhook.foo.com/sd54qad89azd5a\n    method: GET\n    headers:\n      content-type: application/json\n      authorization: Token123456\n    timeout: 10s\n\nregopts:\n  - name: \"myregistry\"\n    username: foo\n    password: bar\n    timeout: 20s\n    insecureTLS: true\n  - name: \"docker.io\"\n    selector: image\n    username: foo2\n    password: bar2\n\nproviders:\n  docker:\n    watchStopped: true\n  swarm:\n    watchByDefault: true\n  kubernetes:\n    namespaces:\n      - default\n      - production\n  file:\n    directory: ./imagesdir\n  nomad:\n    watchByDefault: true\n</code></pre>"},{"location":"config/#environment-variables","title":"Environment variables","text":"<p>All configuration from file can be transposed into environment variables. As an example, the following configuration:</p> diun.yml <pre><code>db:\n  path: diun.db\n\nwatch:\n  workers: 10\n  schedule: \"0 */6 * * *\"\n  jitter: 30s\n  firstCheckNotif: false\n  runOnStartup: true\n\ndefaults:\n  watchRepo: false\n  notifyOn:\n    - new\n    - update\n  sortTags: reverse\n\nnotif:\n  gotify:\n    endpoint: http://gotify.foo.com\n    token: Token123456\n    priority: 1\n    timeout: 10s\n  ntfy:\n    endpoint: https://ntfy.sh\n    topic: diun-acce65a0-b777-46f9-9a11-58c67d1579c4\n    priority: 3\n    timeout: 5s\n  telegram:\n    token: aabbccdd:11223344\n    chatIDs:\n      - 123456789\n      - 987654321\n  webhook:\n    endpoint: http://webhook.foo.com/sd54qad89azd5a\n    method: GET\n    headers:\n      content-type: application/json\n      authorization: Token123456\n    timeout: 10s\n\nregopts:\n  - name: \"docker.io\"\n    selector: image\n    username: foo\n    password: bar\n  - name: \"registry.gitlab.com\"\n    selector: image\n    username: fii\n    password: bor\n    timeout: 20s\n\nproviders:\n  kubernetes:\n    tlsInsecure: false\n    namespaces:\n      - default\n      - production\n</code></pre> <p>Can be transposed to:</p> environment variables <pre><code>DIUN_DB_PATH=diun.db\n\nDIUN_WATCH_WORKERS=10\nDIUN_WATCH_SCHEDULE=0 */6 * * *\nDIUN_WATCH_JITTER=30s\nDIUN_WATCH_FIRSTCHECKNOTIF=false\nDIUN_WATCH_RUNONSTARTUP=true\n\nDIUN_DEFAULTS_WATCHREPO=false\nDIUN_DEFAULTS_NOTIFYON=new,update\nDIUN_DEFAULTS_SORTTAGS=reverse\n\nDIUN_NOTIF_GOTIFY_ENDPOINT=http://gotify.foo.com\nDIUN_NOTIF_GOTIFY_TOKEN=Token123456\nDIUN_NOTIF_GOTIFY_PRIORITY=1\nDIUN_NOTIF_GOTIFY_TIMEOUT=10s\n\nDIUN_NOTIF_NTFY_ENDPOINT=https://ntfy.sh\nDIUN_NOTIF_NTFY_TOPIC=diun-acce65a0-b777-46f9-9a11-58c67d1579c4\nDIUN_NOTIF_NTFY_TAGS=whale\nDIUN_NOTIF_NTFY_TIMEOUT=10s\n\nDIUN_NOTIF_TELEGRAM_TOKEN=aabbccdd:11223344\nDIUN_NOTIF_TELEGRAM_CHATIDS=123456789,987654321\n\nDIUN_NOTIF_WEBHOOK_ENDPOINT=http://webhook.foo.com/sd54qad89azd5a\nDIUN_NOTIF_WEBHOOK_METHOD=GET\nDIUN_NOTIF_WEBHOOK_HEADERS_CONTENT-TYPE=application/json\nDIUN_NOTIF_WEBHOOK_HEADERS_AUTHORIZATION=Token123456\nDIUN_NOTIF_WEBHOOK_TIMEOUT=10s\n\nDIUN_REGOPTS_0_NAME=docker.io\nDIUN_REGOPTS_0_SELECTOR=image\nDIUN_REGOPTS_0_USERNAME=foo\nDIUN_REGOPTS_0_PASSWORD=bar\nDIUN_REGOPTS_1_NAME=registry.gitlab.com\nDIUN_REGOPTS_1_SELECTOR=image\nDIUN_REGOPTS_1_USERNAME=fii\nDIUN_REGOPTS_1_PASSWORD=bor\nDIUN_REGOPTS_1_TIMEOUT=20s\n\nPROVIDERS_KUBERNETES_TLSINSECURE=false\nPROVIDERS_KUBERNETES_NAMESPACES=default,production\n</code></pre>"},{"location":"config/#reference","title":"Reference","text":"<ul> <li>db</li> <li>watch</li> <li>defaults</li> <li>notif<ul> <li>amqp</li> <li>apprise</li> <li>discord</li> <li>elasticsearch</li> <li>gotify</li> <li>mail</li> <li>matrix</li> <li>mqtt</li> <li>ntfy</li> <li>pushover</li> <li>rocketchat</li> <li>script</li> <li>slack</li> <li>signal-rest</li> <li>teams</li> <li>telegram</li> <li>webhook</li> </ul> </li> <li>regopts</li> <li>providers<ul> <li>docker</li> <li>kubernetes</li> <li>swarm</li> <li>nomad</li> <li>dockerfile</li> <li>file</li> </ul> </li> </ul>"},{"location":"config/db/","title":"Database configuration","text":""},{"location":"config/db/#path","title":"<code>path</code>","text":"<p>Path to Bolt database file where images manifests are stored. (default <code>diun.db</code>)</p> <p>Config file</p> <pre><code>db:\n  path: diun.db\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_DB_PATH</code></li> </ul>"},{"location":"config/defaults/","title":"Defaults configuration","text":""},{"location":"config/defaults/#overview","title":"Overview","text":"<p>Defaults allow specifying default values for any configuration that is typically set at the image level using labels or annotations depending on the provider. Any of them will take precedence or be merged over defaults.</p> <pre><code>defaults:\n  watchRepo: false\n  notifyOn:\n    - new\n    - update\n  maxTags: 10\n  sortTags: reverse\n  includeTags:\n    - latest\n  excludeTags:\n    - dev\n  metadata:\n    foo: bar\n</code></pre>"},{"location":"config/defaults/#configuration","title":"Configuration","text":""},{"location":"config/defaults/#watchrepo","title":"<code>watchRepo</code>","text":"<p>Watch all tags of this container image (be careful with this setting). (default <code>false</code>)</p> <p>Config file</p> <pre><code>defaults:\n  watchRepo: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_DEFAULTS_WATCHREPO</code></li> </ul>"},{"location":"config/defaults/#notifyon","title":"<code>notifyOn</code>","text":"<p>List of status to be notified. Can be one of <code>new</code> or <code>update</code>. (default <code>new,update</code>)</p> <p>Config file</p> <pre><code>defaults:\n  notifyOn:\n    - new\n    - update\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_DEFAULTS_NOTIFYON=new,update</code></li> </ul>"},{"location":"config/defaults/#maxtags","title":"<code>maxTags</code>","text":"<p>Maximum number of tags to watch. <code>0</code> means all of them. (default <code>0</code>)</p> <p>Warning</p> <p>Only works if watch repo is enabled.</p> <p>Config file</p> <pre><code>defaults:\n  maxTags: 10\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_DEFAULTS_MAXTAGS=10</code></li> </ul>"},{"location":"config/defaults/#sorttags","title":"<code>sortTags</code>","text":"<p>Sort tags method. Can be one of <code>default</code>, <code>reverse</code>, <code>semver</code>, <code>lexicographical</code>. (default <code>reverse</code>)</p> <p>Warning</p> <p>Only works if watch repo is enabled.</p> <p>Config file</p> <pre><code>defaults:\n  sortTags: reverse\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_DEFAULTS_SORTTAGS=reverse</code></li> </ul>"},{"location":"config/defaults/#includetags","title":"<code>includeTags</code>","text":"<p>List of regular expressions to include tags. Can be useful if watch repo is enabled.</p> <p>Config file</p> <pre><code>defaults:\n  includeTags:\n    - ^\\d+\\.\\d+\\.\\d+$\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_DEFAULTS_INCLUDETAGS=^\\d+\\.\\d+\\.\\d+$</code></li> </ul>"},{"location":"config/defaults/#excludetags","title":"<code>excludeTags</code>","text":"<p>List of regular expressions to exclude tags. Can be useful if watch repo is enabled.</p> <p>Config file</p> <pre><code>defaults:\n  excludeTags:\n    - dev\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_DEFAULTS_EXCLUDETAGS=dev</code></li> </ul>"},{"location":"config/defaults/#metadata","title":"<code>metadata</code>","text":"<p>Additional metadata that can be used in notification template</p> <p>Config file</p> <pre><code>defaults:\n  metadata:\n    foo: bar\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_DEFAULTS_METADATA_FOO=bar</code></li> </ul>"},{"location":"config/notif/","title":"Notifications configuration","text":"<ul> <li><code>amqp</code></li> <li><code>apprise</code></li> <li><code>discord</code></li> <li><code>elasticsearch</code></li> <li><code>gotify</code></li> <li><code>mail</code></li> <li><code>matrix</code></li> <li><code>mqtt</code></li> <li><code>ntfy</code></li> <li><code>pushover</code></li> <li><code>rocketchat</code></li> <li><code>script</code></li> <li><code>signal-rest</code></li> <li><code>slack</code></li> <li><code>teams</code></li> <li><code>telegram</code></li> <li><code>webhook</code></li> </ul>"},{"location":"config/providers/","title":"Providers configuration","text":"<ul> <li><code>docker</code></li> <li><code>kubernetes</code></li> <li><code>swarm</code></li> <li><code>nomad</code></li> <li><code>dockerfile</code></li> <li><code>file</code></li> </ul>"},{"location":"config/regopts/","title":"Registry options configuration","text":""},{"location":"config/regopts/#overview","title":"Overview","text":"<p>Registry options are used to authenticate against a registry during the analysis of an image:</p> <pre><code>regopts:\n  - name: \"myregistry\"\n    username: fii\n    password: bor\n    timeout: 30s\n  - name: \"docker.io\"\n    selector: image\n    username: foo\n    password: bar\n  - name: \"docker.io/crazymax\"\n    selector: image\n    usernameFile: /run/secrets/username\n    passwordFile: /run/secrets/password\n</code></pre> <ul> <li><code>myregistry</code> will be used as a <code>name</code> selector (default) if referenced by its name.</li> <li><code>docker.io</code> will be used as an <code>image</code> selector. If an image is on DockerHub (<code>docker.io</code> domain), this registry options will be selected if not referenced as a <code>regopt</code> name.</li> <li><code>docker.io/crazymax</code> will be used as an <code>image</code> selector. If an image is on DockerHub and in <code>crazymax</code> namespace, this registry options will be selected if not referenced as a <code>regopt</code> name.</li> </ul>"},{"location":"config/regopts/#configuration","title":"Configuration","text":""},{"location":"config/regopts/#name","title":"<code>name</code>","text":"<p>Unique name for registry options. This name can be used through <code>diun.regopt</code> Docker / Swarm label or Kubernetes / Nomad annotation and also as <code>regopt</code> for the Dockerfile and File providers.</p> <p>Warning</p> <ul> <li>Required</li> <li>Must be unique</li> </ul> <p>Config file</p> <pre><code>regopts:\n  - name: \"myregistry\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_REGOPTS_&lt;KEY&gt;_NAME</code></li> </ul>"},{"location":"config/regopts/#selector","title":"<code>selector</code>","text":"<p>What kind of selector to use to retrieve registry options. (default <code>name</code>)</p> <p>Warning</p> <ul> <li>Accepted values are <code>name</code> or <code>image</code></li> </ul> <ul> <li><code>name</code> selector is the default value and will retrieve this registry options only if it's referenced by its name.</li> <li><code>image</code> selector will retrieve this registry options if the given image matches the registry domain or repository path.</li> </ul> <p>Config file</p> <pre><code>regopts:\n  - name: \"myregistry\"\n    selector: name\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_REGOPTS_&lt;KEY&gt;_SELECTOR</code></li> </ul>"},{"location":"config/regopts/#username","title":"<code>username</code>","text":"<p>Registry username.</p> <p>Config file</p> <pre><code>regopts:\n  - name: \"myregistry\"\n    username: foo\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_REGOPTS_&lt;KEY&gt;_USERNAME</code></li> </ul>"},{"location":"config/regopts/#usernamefile","title":"<code>usernameFile</code>","text":"<p>Use content of secret file as registry username if <code>username</code> not defined.</p> <p>Config file</p> <pre><code>regopts:\n  - name: \"myregistry\"\n    usernameFile: /run/secrets/username\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_REGOPTS_&lt;KEY&gt;_USERNAMEFILE</code></li> </ul>"},{"location":"config/regopts/#password","title":"<code>password</code>","text":"<p>Registry password.</p> <p>Config file</p> <pre><code>regopts:\n  - name: \"myregistry\"\n    username: foo\n    password: bar\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_REGOPTS_&lt;KEY&gt;_PASSWORD</code></li> </ul>"},{"location":"config/regopts/#passwordfile","title":"<code>passwordFile</code>","text":"<p>Use content of secret file as registry password if <code>password</code> not defined.</p> <p>Config file</p> <pre><code>regopts:\n  - name: \"myregistry\"\n    passwordFile: /run/secrets/password\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_REGOPTS_&lt;KEY&gt;_PASSWORDFILE</code></li> </ul>"},{"location":"config/regopts/#timeout","title":"<code>timeout</code>","text":"<p>Timeout is the maximum amount of time for the TCP connection to establish. (default <code>0</code> ; no timeout)</p> <p>Config file</p> <pre><code>regopts:\n  - name: \"myregistry\"\n    timeout: 30s\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_REGOPTS_&lt;KEY&gt;_TIMEOUT</code></li> </ul>"},{"location":"config/regopts/#insecuretls","title":"<code>insecureTLS</code>","text":"<p>Allow contacting docker registry over HTTP, or HTTPS with failed TLS verification. (default <code>false</code>)</p> <p>Config file</p> <pre><code>regopts:\n  - name: \"myregistry\"\n    insecureTLS: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_REGOPTS_&lt;KEY&gt;_INSECURETLS</code></li> </ul>"},{"location":"config/watch/","title":"Watch configuration","text":""},{"location":"config/watch/#overview","title":"Overview","text":"<pre><code>watch:\n  workers: 10\n  schedule: \"0 */6 * * *\"\n  jitter: 30s\n  firstCheckNotif: false\n  runOnStartup: true\n  compareDigest: true\n  healthchecks:\n    baseURL: https://hc-ping.com/\n    uuid: 5bf66975-d4c7-4bf5-bcc8-b8d8a82ea278\n</code></pre>"},{"location":"config/watch/#configuration","title":"Configuration","text":""},{"location":"config/watch/#workers","title":"<code>workers</code>","text":"<p>Maximum number of workers that will execute tasks concurrently. (default <code>10</code>)</p> <p>Config file</p> <pre><code>watch:\n  workers: 10\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_WATCH_WORKERS</code></li> </ul>"},{"location":"config/watch/#schedule","title":"<code>schedule</code>","text":"<p>CRON expression to schedule Diun.</p> <p>Warning</p> <p>Remove this setting if you want to run Diun directly.</p> <p>Config file</p> <pre><code>watch:\n  schedule: \"0 */6 * * *\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_WATCH_SCHEDULE</code></li> </ul>"},{"location":"config/watch/#jitter","title":"<code>jitter</code>","text":"<p>Enable time jitter. Prior to executing of a job, cron will sleep a random duration in the range from 0 to jitter. (default <code>30s</code>)</p> <p>Note</p> <p>Only works with <code>schedule</code> setting. <code>0</code> disables time jitter.</p> <p>Config file</p> <pre><code>watch:\n  schedule: \"0 */6 * * *\"\n  jitter: 30s\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_WATCH_JITTER</code></li> </ul>"},{"location":"config/watch/#firstchecknotif","title":"<code>firstCheckNotif</code>","text":"<p>Send notification at the very first analysis of an image. (default <code>false</code>)</p> <p>Config file</p> <pre><code>watch:\n  firstCheckNotif: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_WATCH_FIRSTCHECKNOTIF</code></li> </ul>"},{"location":"config/watch/#runonstartup","title":"<code>runOnStartup</code>","text":"<p>Check for updates on startup. (default <code>true</code>)</p> <p>Config file</p> <pre><code>watch:\n  runOnStartup: true\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_WATCH_RUNONSTARTUP</code></li> </ul>"},{"location":"config/watch/#comparedigest","title":"<code>compareDigest</code>","text":"<p>Compare the digest of an image with the registry before downloading the image manifest. It is strongly recommended leaving this value at <code>true</code>, especially with Docker Hub which imposes a rate-limit on image pull. (default <code>true</code>)</p> <p>Config file</p> <pre><code>watch:\n  compareDigest: true\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_WATCH_COMPAREDIGEST</code></li> </ul>"},{"location":"config/watch/#healthchecks","title":"<code>healthchecks</code>","text":"<p>Healthchecks allows monitoring Diun watcher by sending start and success notification events to healthchecks.io.</p> <p>Tip</p> <p>A Docker image for Healthchecks is available if you want to self-host your instance.</p> <p></p> <p>Config file</p> <pre><code>watch:\n  healthchecks:\n    baseURL: https://hc-ping.com/\n    uuid: 5bf66975-d4c7-4bf5-bcc8-b8d8a82ea278\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_WATCH_HEALTHCHECKS_BASEURL</code></li> <li><code>DIUN_WATCH_HEALTHCHECKS_UUID</code></li> </ul> <ul> <li><code>baseURL</code>: Base URL for the Healthchecks Ping API (default <code>https://hc-ping.com/</code>).</li> <li><code>uuid</code>: UUID of an existing healthcheck (required).</li> </ul>"},{"location":"install/binary/","title":"Installation from binary","text":""},{"location":"install/binary/#download","title":"Download","text":"<p>Diun binaries are available on releases page.</p> <p>Choose the archive matching the destination platform:</p> <ul> <li>diun_4.31.0-7-g626d2046_darwin_amd64.tar.gz</li> <li>diun_4.31.0-7-g626d2046_darwin_arm64.tar.gz</li> <li>diun_4.31.0-7-g626d2046_linux_386.tar.gz</li> <li>diun_4.31.0-7-g626d2046_linux_amd64.tar.gz</li> <li>diun_4.31.0-7-g626d2046_linux_arm64.tar.gz</li> <li>diun_4.31.0-7-g626d2046_linux_armv5.tar.gz</li> <li>diun_4.31.0-7-g626d2046_linux_armv6.tar.gz</li> <li>diun_4.31.0-7-g626d2046_linux_armv7.tar.gz</li> <li>diun_4.31.0-7-g626d2046_linux_ppc64le.tar.gz</li> <li>diun_4.31.0-7-g626d2046_linux_riscv64.tar.gz</li> <li>diun_4.31.0-7-g626d2046_linux_s390x.tar.gz</li> <li>diun_4.31.0-7-g626d2046_windows_386.zip</li> <li>diun_4.31.0-7-g626d2046_windows_amd64.zip</li> <li>diun_4.31.0-7-g626d2046_windows_arm64.zip</li> </ul> <p>And extract diun:</p> <pre><code>wget -qO- https://github.com/crazy-max/diun/releases/download/v4.31.0-7-g626d2046/diun_4.31.0-7-g626d2046_linux_amd64.tar.gz | tar -zxvf - diun\n</code></pre> <p>After getting the binary, it can be tested with <code>./diun --help</code> command and moved to a permanent location.</p>"},{"location":"install/binary/#server-configuration","title":"Server configuration","text":"<p>Steps below are the recommended server configuration.</p>"},{"location":"install/binary/#prepare-environment","title":"Prepare environment","text":"<p>Create user to run diun (ex. <code>diun</code>)</p> <pre><code>groupadd diun\nuseradd -s /bin/false -d /bin/null -g diun diun\n</code></pre>"},{"location":"install/binary/#create-required-directory-structure","title":"Create required directory structure","text":"<pre><code>mkdir -p /var/lib/diun\nchown diun:diun /var/lib/diun/\nchmod -R 750 /var/lib/diun/\nmkdir /etc/diun\nchown diun:diun /etc/diun\nchmod 770 /etc/diun\n</code></pre>"},{"location":"install/binary/#configuration","title":"Configuration","text":"<p>Create your first configuration file in <code>/etc/diun/diun.yml</code> and type:</p> <pre><code>chown diun:diun /etc/diun/diun.yml\nchmod 644 /etc/diun/diun.yml\n</code></pre> <p>Note</p> <p>Not required if you want to only rely on environment variables</p>"},{"location":"install/binary/#copy-binary-to-global-location","title":"Copy binary to global location","text":"<pre><code>cp diun /usr/local/bin/diun\n</code></pre>"},{"location":"install/binary/#running-diun","title":"Running Diun","text":"<p>After the above steps, two options to run Diun:</p>"},{"location":"install/binary/#1-creating-a-service-file-recommended","title":"1. Creating a service file (recommended)","text":"<p>See how to create Linux service to start Diun automatically.</p>"},{"location":"install/binary/#2-running-from-terminal","title":"2. Running from terminal","text":"<pre><code>DIUN_DB_PATH=/var/lib/diun/diun.db /usr/local/bin/diun serve --config /etc/diun/diun.yml\n</code></pre>"},{"location":"install/binary/#updating-to-a-new-version","title":"Updating to a new version","text":"<p>You can update to a new version of Diun by stopping it, replacing the binary at <code>/usr/local/bin/diun</code> and restarting the instance.</p> <p>If you have carried out the installation steps as described above, the binary should have the generic name <code>diun</code>. Do not change this, i.e. to include the version number.</p>"},{"location":"install/docker/","title":"Installation from Docker image","text":""},{"location":"install/docker/#about","title":"About","text":"<p>Diun provides automatically updated Docker  images within several registries:</p> Registry Image Docker Hub <code>crazymax/diun</code> GitHub Container Registry <code>ghcr.io/crazy-max/diun</code> <p>It is possible to always use the latest stable tag or to use another service that handles updating Docker images.</p> <p>Following platforms for this image are available:</p> <pre><code>$ docker run --rm mplatform/mquery crazymax/diun:latest\nImage: crazymax/diun:latest\n * Manifest List: Yes\n * Supported platforms:\n   - linux/amd64\n   - linux/arm/v6\n   - linux/arm/v7\n   - linux/arm64\n   - linux/386\n   - linux/ppc64le\n</code></pre>"},{"location":"install/docker/#volumes","title":"Volumes","text":"Path Description <code>/data</code> Contains bbolt database which retains Docker images manifests"},{"location":"install/docker/#usage","title":"Usage","text":"<p>Note</p> <p>This reference setup guides users through the setup based on Docker Compose and the Docker provider, but the installation of Docker Compose is out of scope of this documentation. To install Docker Compose itself, follow the official install instructions.</p> <p>You can also use the Swarm or Kubernetes providers if you don't want to use Docker Compose.</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"DIUN_WATCH_WORKERS=20\"\n      - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\"\n      - \"DIUN_WATCH_JITTER=30s\"\n      - \"DIUN_PROVIDERS_DOCKER=true\"\n    labels:\n      - \"diun.enable=true\"\n    restart: always\n</code></pre> <p>Edit this example with your preferences and run the following commands to bring up Diun:</p> <pre><code>docker compose up -d\ndocker compose logs -f\n</code></pre> <p>Or use the following command:</p> <pre><code>docker run -d --name diun \\\n  -e \"TZ=Europe/Paris\" \\\n  -e \"DIUN_WATCH_WORKERS=20\" \\\n  -e \"DIUN_WATCH_SCHEDULE=0 */6 * * *\" \\\n  -e \"DIUN_WATCH_JITTER=30s\" \\\n  -e \"DIUN_PROVIDERS_DOCKER=true\" \\\n  -v \"$PWD/data:/data\" \\\n  -v \"/var/run/docker.sock:/var/run/docker.sock\" \\\n  -l \"diun.enable=true\" \\\n  crazymax/diun:latest\n</code></pre> <p>To upgrade your installation to the latest release:</p> <pre><code>docker compose pull\ndocker compose up -d\n</code></pre> <p>If you prefer to rely on the configuration file instead of environment variables:</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"./diun.yml:/diun.yml:ro\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"LOG_LEVEL=info\"\n      - \"LOG_JSON=false\"\n    restart: always\n</code></pre> <pre><code># ./diun.yml\n\nwatch:\n  workers: 20\n  schedule: \"0 */6 * * *\"\n\nproviders:\n  docker:\n    watchStopped: true\n</code></pre>"},{"location":"install/docker/#podman","title":"Podman","text":"<p>If you're using Podman there are some small changes:</p> <pre><code>version: \"3.5\"\n\nservices:\n  diun_app:\n    image: docker.io/crazymax/diun:latest\n    # security_opt is neccessary if you use podman in rootless mode to apply the correct SELinux rules\n    security_opt:\n      - \"label=type:container_runtime_t\"\n    volumes:\n      - \"./data:/data\"\n      # root mode\n      - \"/run/podman/podman.sock:/var/run/docker.sock\"\n      # rootless mode\n      #- \"$XDG_RUNTIME_DIR/podman/podman.sock:/var/run/docker.sock\"\n      #- \"/run/user/1000/podman/podman.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"DIUN_WATCH_WORKERS=20\"\n      - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\"\n      - \"DIUN_WATCH_JITTER=30s\"\n      - \"DIUN_PROVIDERS_DOCKER=true\"\n    labels:\n      - \"diun.enable=true\"\n    restart: always\n</code></pre> <p>Edit this example with your preferences and run the following commands to bring up Diun with <code>podman-compose</code>:</p> <pre><code>podman-compose up -d\npodman-compose logs -f\n</code></pre>"},{"location":"install/linux-service/","title":"Run as service on Debian based distro","text":""},{"location":"install/linux-service/#using-systemd","title":"Using systemd","text":"<p>Warning</p> <p>Make sure to follow the instructions to install from binary before.</p> <p>To create a new service, paste this content in <code>/etc/systemd/system/diun.service</code>:</p> <pre><code>[Unit]\nDescription=Diun\nDocumentation=https://crazymax.dev/diun/\nAfter=syslog.target\nAfter=network.target\n\n[Service]\nRestartSec=2s\nType=simple\nUser=diun\nGroup=diun\nExecStart=/usr/local/bin/diun serve --config /etc/diun/diun.yml --log-level info\nRestart=always\n#Environment=TZ=Europe/Paris\nEnvironment=DIUN_DB_PATH=/var/lib/diun/diun.db\n\n[Install]\nWantedBy=multi-user.target\n</code></pre> <p>Change the user, group, and other required startup values following your needs.</p> <p>Enable and start Diun at boot:</p> <pre><code>sudo systemctl enable diun\nsudo systemctl start diun\n</code></pre> <p>To view logs:</p> <pre><code>journalctl -fu diun.service\n</code></pre>"},{"location":"migration/v0-to-v1/","title":"Diun v0 to v1","text":"<p>Some fields in configuration file has been changed:</p> <ul> <li><code>registries</code> renamed <code>regopts</code></li> <li><code>items</code> renamed <code>image</code></li> <li><code>items[].image</code> renamed <code>image[].name</code></li> <li><code>items[].registry_id</code> renamed <code>image[].regopts_id</code></li> <li><code>watch.os</code> and <code>watch.arch</code> moved to <code>image[].os</code> and <code>image[].arch</code></li> </ul> <p>v0</p> <pre><code>watch:\n  os: linux\n  arch: amd64\n\nregistries:\n  someregistryoptions:\n    username: foo\n    password: bar\n    timeout: 20\n\nitems:\n  - image: docker.io/crazymax/nextcloud:latest\n    registry_id: someregistryoptions\n</code></pre> <p>v1</p> <pre><code>regopts:\n  someregistryoptions:\n    username: foo\n    password: bar\n    timeout: 20\n\nimage:\n  - name: docker.io/crazymax/nextcloud:latest\n    regopts_id: someregistryoptions\n    os: linux\n    arch: amd64\n</code></pre>"},{"location":"migration/v1-to-v2/","title":"Diun v1 to v2","text":"<p><code>image</code> field has been moved to <code>providers.static</code> in configuration file:</p> <p>v1</p> <pre><code>image:\n  - name: docker.io/crazymax/diun\n    watch_repo: true\n    max_tags: 10\n</code></pre> <p>v2</p> <pre><code>providers:\n  static:\n    - name: docker.io/crazymax/diun\n      watch_repo: true\n      max_tags: 10\n</code></pre>"},{"location":"migration/v2-to-v3/","title":"Diun v2 to v3","text":""},{"location":"migration/v2-to-v3/#file-provider","title":"File provider","text":"<p><code>static</code> provider has been renamed <code>file</code>. This now allows the static configuration to be declared in one or more files to avoid overloading the current configuration file and also dynamic updating.</p> <p>v2</p> <pre><code>providers:\n  static:\n    - name: docker.io/crazymax/diun\n      watch_repo: true\n      max_tags: 10\n</code></pre> <p>v3</p> <p><pre><code>providers:\n  file:\n    # Watch images from filename /path/to/config.yml\n    filename: /path/to/config.yml\n    # OR watch images from directory /path/to/config/folder\n    directory: /path/to/config/folder\n</code></pre> <pre><code># /path/to/config.yml\n- name: docker.io/crazymax/diun\n  watch_repo: true\n  max_tags: 10\n</code></pre></p>"},{"location":"migration/v2-to-v3/#allow-only-one-docker-and-swarm-provider","title":"Allow only one Docker and Swarm provider","text":"<p>Now you can declare only one Docker and/or Swarm provider. This is due to a limitation of the Docker engine.</p> <p>v2</p> <pre><code>providers:\n  docker:\n    mydocker:\n      watch_stopped: true\n  swarm:\n    myswarm:\n      watch_by_default: true\n</code></pre> <p>v3</p> <pre><code>providers:\n  docker:\n    watch_stopped: true\n  swarm:\n    watch_by_default: true\n</code></pre>"},{"location":"migration/v2-to-v3/#remove-enable-setting-for-notifiers","title":"Remove <code>enable</code> setting for notifiers","text":"<p>The <code>enable</code> entry has been removed for notifiers. If you don't want a notifier to be enabled, you must now remove or comment its configuration.</p> <p>v2</p> <pre><code>notif:\n  amqp:\n    enable: false\n    host: localhost\n    port: 5672\n  gotify:\n    enable: true\n    endpoint: http://gotify.foo.com\n    token: Token123456\n    priority: 1\n    timeout: 10\n</code></pre> <p>v3</p> <pre><code>notif:\n  gotify:\n    endpoint: http://gotify.foo.com\n    token: Token123456\n    priority: 1\n    timeout: 10\n</code></pre>"},{"location":"migration/v3-to-v4/","title":"Diun v3 to v4","text":""},{"location":"migration/v3-to-v4/#timeout-value-as-duration","title":"Timeout value as duration","text":"<p>Only accept duration as timeout value (<code>10</code> becomes <code>10s</code>)</p>"},{"location":"migration/v3-to-v4/#registry-options-enhancements","title":"Registry options enhancements","text":"<p>Configuration of registry options has changed:</p> v3 <pre><code>regopts:\n  myregistry:\n    username: fii\n    password: bor\n    insecure_tls: true\n    timeout: 5s\n  docker.io:\n    username: foo\n    password: bar\n  docker.io/crazymax:\n    username_file: /run/secrets/username\n    password_file: /run/secrets/password\n</code></pre> v4 <pre><code>regopts:\n  - name: \"myregistry\"\n    username: fii\n    password: bor\n    insecureTLS: true\n    timeout: 5s\n  - name: \"docker.io\"\n    selector: image\n    username: foo\n    password: bar\n  - name: \"docker.io/crazymax\"\n    selector: image\n    usernameFile: /run/secrets/username\n    passwordFile: /run/secrets/password\n</code></pre> <p>Also, registry options can now be resolved automatically based on image name. Take a look at the Registry options configuration for more details.</p>"},{"location":"migration/v3-to-v4/#configuration-transposed-into-environment-variables","title":"Configuration transposed into environment variables","text":"<p>All configuration is now transposed into environment variables. Take a look at the documentation for more details.</p> <p><code>DIUN_DB</code> env var has been renamed <code>DIUN_DB_PATH</code> to follow environment variables transposition.</p>"},{"location":"migration/v3-to-v4/#all-fields-in-configuration-are-now-camelcased","title":"All fields in configuration are now camelCased","text":"<p>In order to enable transposition into environmental variables, all fields in configuration are now camelCased:</p> <ul> <li><code>notif.mail.insecure_skip_verify</code> &gt; <code>notif.mail.insecureSkipVerify</code></li> <li><code>notif.rocketchat.user_id</code> &gt; <code>notif.rocketchat.userID</code></li> <li><code>watch.first_check_notif</code> &gt; <code>watch.firstCheckNotif</code></li> <li>...</li> </ul> v3 <pre><code>db:\n  path: diun.db\n\nwatch:\n  workers: 10\n  schedule: \"0 */6 * * *\"\n  first_check_notif: false\n\nnotif:\n  amqp:\n    host: localhost\n    port: 5672\n    username: guest\n    password: guest\n    exchange: \n    queue: queue\n  gotify:\n    endpoint: http://gotify.foo.com\n    token: Token123456\n    priority: 1\n    timeout: 10\n  mail:\n    host: localhost\n    port: 25\n    ssl: false\n    insecure_skip_verify: false\n    username:\n    password:\n    from:\n    to:\n  rocketchat:\n    endpoint: http://rocket.foo.com:3000\n    channel: \"#general\"\n    user_id: abcdEFGH012345678\n    token: Token123456\n    timeout: 10\n  script:\n      cmd: \"myprogram\"\n      args:\n        - \"--anarg\"\n        - \"another\"\n  slack:\n    webhook_url: https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij\n  teams:\n    webhook_url: https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij\n  telegram:\n    token: aabbccdd:11223344\n    chat_ids:\n      - 123456789\n      - 987654321\n  webhook:\n    endpoint: http://webhook.foo.com/sd54qad89azd5a\n    method: GET\n    headers:\n      Content-Type: application/json\n      Authorization: Token123456\n    timeout: 10\n\nregopts:\n  myregistry:\n    username: fii\n    password: bor\n    insecure_tls: true\n    timeout: 5s\n  docker.io:\n    username: foo\n    password: bar\n  docker.io/crazymax:\n    username_file: /run/secrets/username\n    password_file: /run/secrets/password\n\nproviders:\n  docker:\n    watch_stopped: true\n  swarm:\n    watch_by_default: true\n  file:\n    directory: ./imagesdir\n</code></pre> v4 <pre><code>db:\n  path: diun.db\n\nwatch:\n  workers: 10\n  schedule: \"0 */6 * * *\"\n  firstCheckNotif: false\n\nnotif:\n  amqp:\n    host: localhost\n    port: 5672\n    username: guest\n    password: guest\n    queue: queue\n  gotify:\n    endpoint: http://gotify.foo.com\n    token: Token123456\n    priority: 1\n    timeout: 10s\n  mail:\n    host: localhost\n    port: 25\n    ssl: false\n    insecureSkipVerify: false\n    from: diun@example.com\n    to: webmaster@example.com\n  rocketchat:\n    endpoint: http://rocket.foo.com:3000\n    channel: \"#general\"\n    userID: abcdEFGH012345678\n    token: Token123456\n    timeout: 10s\n  script:\n      cmd: \"myprogram\"\n      args:\n        - \"--anarg\"\n        - \"another\"\n  slack:\n    webhookURL: https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij\n  teams:\n    webhookURL: https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij\n  telegram:\n    token: aabbccdd:11223344\n    chatIDs:\n      - 123456789\n      - 987654321\n  webhook:\n    endpoint: http://webhook.foo.com/sd54qad89azd5a\n    method: GET\n    headers:\n      content-type: application/json\n      authorization: Token123456\n    timeout: 10s\n\nregopts:\n  - name: \"myregistry\"\n    username: fii\n    password: bor\n    insecureTLS: true\n    timeout: 5s\n  - name: \"docker.io\"\n    selector: image\n    username: foo\n    password: bar\n  - name: \"docker.io/crazymax\"\n    selector: image\n    usernameFile: /run/secrets/username\n    passwordFile: /run/secrets/password\n\nproviders:\n  docker:\n    watchStopped: true\n  swarm:\n    watchByDefault: true\n  kubernetes:\n    namespaces:\n      - default\n      - production\n  file:\n    directory: ./imagesdir\n</code></pre>"},{"location":"migration/v3-to-v4/#diunyml-not-loaded-by-default-in-docker-image","title":"<code>/diun.yml</code> not loaded by default in Docker image","text":"<p>Following the transposition of the configuration into environment variables, the configuration file <code>/diun.yml</code> is no longer loaded by default in the official Docker image.</p> <p>If you want to load a configuration file through the Docker image you will have to declare the <code>CONFIG</code> environment variable with <code>serve</code> command pointing to the assigned configuration file:</p> <p>Tip</p> <p>This is no longer required since version 4.2.0. Now configuration file can be loaded from default places</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    container_name: diun\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"./diun.yml:/diun.yml:ro\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"CONFIG=/diun.yml\"\n      - \"TZ=Europe/Paris\"\n      - \"LOG_LEVEL=info\"\n      - \"LOG_JSON=false\"\n    restart: always\n</code></pre>"},{"location":"migration/v4.0-to-v4.17/","title":"Diun v4.0 to v4.17","text":""},{"location":"migration/v4.0-to-v4.17/#new-cli","title":"New CLI","text":"<p>CLI has changed since 4.17 and includes <code>serve</code> command to start Diun:</p> <p>v4.0</p> <pre><code>diun --config diun.yml\n</code></pre> <p>v4.17</p> <pre><code>diun serve --config diun.yml\n</code></pre>"},{"location":"migration/v4.1-to-v4.29/","title":"Diun v4.28 to v4.29","text":""},{"location":"migration/v4.1-to-v4.29/#telegram-chatdids-and-chatidsfile-attributes-change","title":"Telegram <code>chatdIDs</code> and <code>chatIDsFile</code> attributes change","text":"<p>The <code>chatIDs</code> attribute has changed from a list of integers to a list of strings. If you are using Telegram notifications, you need to update your configuration file:</p> <p>v4.1</p> <pre><code>notif:\n  telegram:\n    token: aabbccdd:11223344\n    chatIDs:\n      - 123456789\n      - 987654321\n</code></pre> <p>v4.29</p> <pre><code>notif:\n  telegram:\n    token: aabbccdd:11223344\n    chatIDs:\n      - \"123456789\"\n      - \"987654321\"\n</code></pre> <p>The same applies for the <code>chatIDsFile</code> attribute content:</p> <p>v4.1</p> <pre><code>[123456789,987654321]\n</code></pre> <p>v4.29</p> <pre><code>[\"123456789\",\"987654321\"]\n</code></pre> <p>More information on Telegram notifications page.</p>"},{"location":"notif/amqp/","title":"Amqp notifications","text":"<p>You can send notifications to any amqp compatible server with the following settings.</p>"},{"location":"notif/amqp/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  amqp:\n    host: localhost\n    port: 5672\n    username: guest\n    password: guest\n    queue: queue\n</code></pre> Name Default Description <code>host</code><sup>1</sup> <code>localhost</code> AMQP server host <code>port</code><sup>1</sup> <code>5672</code> AMQP server port <code>username</code> AMQP username <code>usernameFile</code> Use content of secret file as AMQP username if <code>username</code> not defined <code>password</code> AMQP password <code>passwordFile</code> Use content of secret file as AMQP password if <code>password</code> not defined <code>exchange</code> Name of the exchange the message will be sent to <code>queue</code><sup>1</sup> Name of the queue the message will be sent to <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_AMQP_HOST</code></li> <li><code>DIUN_NOTIF_AMQP_PORT</code></li> <li><code>DIUN_NOTIF_AMQP_USERNAME</code></li> <li><code>DIUN_NOTIF_AMQP_USERNAMEFILE</code></li> <li><code>DIUN_NOTIF_AMQP_PASSWORD</code></li> <li><code>DIUN_NOTIF_AMQP_PASSWORDFILE</code></li> <li><code>DIUN_NOTIF_AMQP_EXCHANGE</code></li> <li><code>DIUN_NOTIF_AMQP_QUEUE</code></li> </ul>"},{"location":"notif/amqp/#sample","title":"Sample","text":"<p>The JSON response will look like this:</p> <pre><code>{\n  \"diun_version\": \"0.3.0\",\n  \"hostname\": \"myserver\",\n  \"status\": \"new\",\n  \"provider\": \"file\",\n  \"image\": \"docker.io/crazymax/swarm-cronjob:0.2.1\",\n  \"hub_link\": \"https://hub.docker.com/r/crazymax/swarm-cronjob\",\n  \"mime_type\": \"application/vnd.docker.distribution.manifest.v2+json\",\n  \"digest\": \"sha256:5913d4b5e8dc15430c2f47f40e43ab2ca7f2b8df5eee5db4d5c42311e08dfb79\",\n  \"created\": \"2019-01-24T10:26:49.152006005Z\",\n  \"platform\": \"linux/amd64\"\n}\n</code></pre> <ol> <li> <p>Value required\u00a0\u21a9\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/apprise/","title":"Apprise notifications","text":"<p>Notifications can be sent using an apprise api instance.</p>"},{"location":"notif/apprise/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>    notif:\n      apprise:\n        endpoint: http://apprise:8000\n        token: abc\n        tags:\n          - diun\n        timeout: 10s\n        templateTitle: \"{{ .Entry.Image }} released\"\n        templateBody: |\n          Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>endpoint</code><sup>1</sup> Hostname and port of your apprise api instance <code>token</code><sup>2</sup> token representing your config file (Config Key) <code>tokenFile</code> Use content of secret file as application token if <code>token</code> not defined <code>tags</code> List of Tags in your config file you want to notify <code>urls</code><sup>2</sup> List of URLs to notify <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>tlsSkipVerify</code> <code>false</code> Skip TLS certificate verification <code>tlsCaCertFiles</code> List of paths to custom CA certificate files to use for TLS verification <code>templateTitle</code> See below Notification template for message title <code>templateBody</code> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_APPRISE_ENDPOINT</code></li> <li><code>DIUN_NOTIF_APPRISE_TOKEN</code></li> <li><code>DIUN_NOTIF_APPRISE_TAGS</code></li> <li><code>DIUN_NOTIF_APPRISE_URLS</code></li> <li><code>DIUN_NOTIF_APPRISE_TIMEOUT</code></li> <li><code>DIUN_NOTIF_APPRISE_TLSSKIPVERIFY</code></li> <li><code>DIUN_NOTIF_APPRISE_TLSCACERTFILES</code></li> <li><code>DIUN_NOTIF_APPRISE_TEMPLATETITLE</code></li> <li><code>DIUN_NOTIF_APPRISE_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/apprise/#default-templatetitle","title":"Default <code>templateTitle</code>","text":"<pre><code>{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}\n</code></pre>"},{"location":"notif/apprise/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).\n</code></pre> <ol> <li> <p>Value required\u00a0\u21a9</p> </li> <li> <p>One of these 2 values is required\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/discord/","title":"Discord notifications","text":"<p>Allow sending notifications to your Discord channel.</p>"},{"location":"notif/discord/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  discord:\n    webhookURL: https://discordapp.com/api/webhooks/1234567890/Abcd-eFgh-iJklmNo_pqr\n    mentions:\n      - \"@here\"\n      - \"@everyone\"\n      - \"&lt;@124&gt;\"\n      - \"&lt;@125&gt;\"\n      - \"&lt;@&amp;200&gt;\"\n    renderEmbeds: true\n    renderFields: true\n    timeout: 10s\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>webhookURL</code> Discord incoming webhook URL <code>webhookURLFile</code> Use content of secret file as webhook URL if <code>webhookURL</code> is not defined <code>mentions</code> List of users or roles to notify <code>renderEmbeds</code> <code>true</code> Render message embeds <code>renderFields</code> <code>true</code> Render field objects in message embeds <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_DISCORD_WEBHOOKURL</code></li> <li><code>DIUN_NOTIF_DISCORD_WEBHOOKURLFILE</code></li> <li><code>DIUN_NOTIF_DISCORD_MENTIONS</code> (comma separated)</li> <li><code>DIUN_NOTIF_DISCORD_RENDEREMBEDS</code></li> <li><code>DIUN_NOTIF_DISCORD_RENDERFIELDS</code></li> <li><code>DIUN_NOTIF_DISCORD_TIMEOUT</code></li> <li><code>DIUN_NOTIF_DISCORD_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/discord/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).\n</code></pre>"},{"location":"notif/discord/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9</p> </li> </ol>"},{"location":"notif/elasticsearch/","title":"Elasticsearch notifications","text":"<p>Send notifications to your Elasticsearch cluster as structured documents.</p>"},{"location":"notif/elasticsearch/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  elasticsearch:\n    address: http://localhost:9200\n    username: elastic\n    password: password\n    client: diun\n    index: diun-notifications\n    timeout: 10s\n</code></pre> Name Default Description <code>address</code><sup>1</sup> <code>http://localhost:9200</code> Elasticsearch base URL <code>username</code> Elasticsearch username for authentication <code>usernameFile</code> Use content of secret file as username if <code>username</code> is not defined <code>password</code> Elasticsearch password for authentication <code>passwordFile</code> Use content of secret file as password if <code>password</code> is not defined <code>client</code><sup>1</sup> <code>diun</code> Client name to identify the source of notifications <code>index</code><sup>1</sup> <code>diun-notifications</code> Elasticsearch index name where notifications will be stored <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>tlsSkipVerify</code> <code>false</code> Skip TLS certificate verification <code>tlsCaCertFiles</code> List of paths to custom CA certificate files to use for TLS verification <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_ELASTICSEARCH_ADDRESS</code></li> <li><code>DIUN_NOTIF_ELASTICSEARCH_USERNAME</code></li> <li><code>DIUN_NOTIF_ELASTICSEARCH_USERNAMEFILE</code></li> <li><code>DIUN_NOTIF_ELASTICSEARCH_PASSWORD</code></li> <li><code>DIUN_NOTIF_ELASTICSEARCH_PASSWORDFILE</code></li> <li><code>DIUN_NOTIF_ELASTICSEARCH_CLIENT</code></li> <li><code>DIUN_NOTIF_ELASTICSEARCH_INDEX</code></li> <li><code>DIUN_NOTIF_ELASTICSEARCH_TIMEOUT</code></li> <li><code>DIUN_NOTIF_ELASTICSEARCH_TLSSKIPVERIFY</code></li> <li><code>DIUN_NOTIF_ELASTICSEARCH_TLSCACERTFILES</code></li> </ul>"},{"location":"notif/elasticsearch/#document-structure","title":"Document Structure","text":"<p>Each notification is stored as a JSON document with the following structure:</p> <pre><code>{\n  \"diun_version\": \"4.24.0\",\n  \"hostname\": \"myserver\",\n  \"status\": \"new\",\n  \"provider\": \"file\",\n  \"image\": \"docker.io/crazymax/diun:latest\",\n  \"hub_link\": \"https://hub.docker.com/r/crazymax/diun\",\n  \"mime_type\": \"application/vnd.docker.distribution.manifest.list.v2+json\",\n  \"digest\": \"sha256:216e3ae7de4ca8b553eb11ef7abda00651e79e537e85c46108284e5e91673e01\",\n  \"created\": \"2020-03-26T12:23:56Z\",\n  \"platform\": \"linux/amd64\",\n  \"client\": \"diun\",\n  \"metadata\": {\n    \"ctn_command\": \"diun serve\",\n    \"ctn_createdat\": \"2022-12-29 10:22:15 +0100 CET\",\n    \"ctn_id\": \"0dbd10e15b31add2c48856fd34451adabf50d276efa466fe19a8ef5fbd87ad7c\",\n    \"ctn_names\": \"diun\",\n    \"ctn_size\": \"0B\",\n    \"ctn_state\": \"running\",\n    \"ctn_status\": \"Up Less than a second (health: starting)\"\n  }\n}\n</code></pre>"},{"location":"notif/elasticsearch/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/gotify/","title":"Gotify notifications","text":"<p>Notifications can be sent using a Gotify instance.</p>"},{"location":"notif/gotify/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  gotify:\n    endpoint: http://gotify.foo.com\n    token: Token123456\n    priority: 1\n    timeout: 10s\n    templateTitle: \"{{ .Entry.Image }} released\"\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>endpoint</code><sup>1</sup> Gotify base URL <code>token</code> Application token <code>tokenFile</code> Use content of secret file as application token if <code>token</code> not defined <code>priority</code> <code>1</code> The priority of the message <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>tlsSkipVerify</code> <code>false</code> Skip TLS certificate verification <code>tlsCaCertFiles</code> List of paths to custom CA certificate files to use for TLS verification <code>templateTitle</code><sup>1</sup> See below Notification template for message title <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_GOTIFY_ENDPOINT</code></li> <li><code>DIUN_NOTIF_GOTIFY_TOKEN</code></li> <li><code>DIUN_NOTIF_GOTIFY_TOKENFILE</code></li> <li><code>DIUN_NOTIF_GOTIFY_PRIORITY</code></li> <li><code>DIUN_NOTIF_GOTIFY_TIMEOUT</code></li> <li><code>DIUN_NOTIF_GOTIFY_TLSSKIPVERIFY</code></li> <li><code>DIUN_NOTIF_GOTIFY_TLSCACERTFILES</code></li> <li><code>DIUN_NOTIF_GOTIFY_TEMPLATETITLE</code></li> <li><code>DIUN_NOTIF_GOTIFY_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/gotify/#default-templatetitle","title":"Default <code>templateTitle</code>","text":"<pre><code>{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}\n</code></pre>"},{"location":"notif/gotify/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).\n</code></pre>"},{"location":"notif/gotify/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/mail/","title":"Mail notifications","text":"<p>Notifications can be sent through SMTP.</p>"},{"location":"notif/mail/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  mail:\n    host: localhost\n    port: 25\n    ssl: false\n    insecureSkipVerify: false\n    from: diun@example.com\n    to:\n      - webmaster@example.com\n      - me@example.com\n    templateTitle: \"{{ .Entry.Image }} released\"\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>host</code><sup>1</sup> <code>localhost</code> SMTP server host <code>port</code><sup>1</sup> <code>25</code> SMTP server port <code>ssl</code> <code>false</code> SSL defines whether an SSL connection is used. Should be false in most cases since the auth mechanism should use STARTTLS <code>insecureSkipVerify</code> <code>false</code> Controls whether a client verifies the server's certificate chain and hostname <code>localName</code> <code>localhost</code> Hostname sent to the SMTP server with the HELO command <code>username</code> SMTP username <code>usernameFile</code> Use content of secret file as SMTP username if <code>username</code> not defined <code>password</code> SMTP password <code>passwordFile</code> Use content of secret file as SMTP password if <code>password</code> not defined <code>from</code><sup>1</sup> Sender email address <code>to</code><sup>1</sup> List of recipients email addresses <code>templateTitle</code><sup>1</sup> See below Notification template for message title <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_MAIL_HOST</code></li> <li><code>DIUN_NOTIF_MAIL_PORT</code></li> <li><code>DIUN_NOTIF_MAIL_SSL</code></li> <li><code>DIUN_NOTIF_MAIL_INSECURESKIPVERIFY</code></li> <li><code>DIUN_NOTIF_MAIL_LOCALNAME</code></li> <li><code>DIUN_NOTIF_MAIL_USERNAME</code></li> <li><code>DIUN_NOTIF_MAIL_USERNAMEFILE</code></li> <li><code>DIUN_NOTIF_MAIL_PASSWORD</code></li> <li><code>DIUN_NOTIF_MAIL_PASSWORDFILE</code></li> <li><code>DIUN_NOTIF_MAIL_FROM</code></li> <li><code>DIUN_NOTIF_MAIL_TO</code> (comma separated)</li> <li><code>DIUN_NOTIF_MAIL_TEMPLATETITLE</code></li> <li><code>DIUN_NOTIF_MAIL_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/mail/#default-templatetitle","title":"Default <code>templateTitle</code>","text":"<pre><code>{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}\n</code></pre>"},{"location":"notif/mail/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }}\nwhich you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}\non **{{ .Entry.Image.Domain }}** registry (triggered by _{{ escapeMarkdown .Meta.Hostname }}_ host).\n\nThis image has been {{ if (eq .Entry.Status \"new\") }}created{{ else }}updated{{ end }} at\n&lt;code&gt;{{ .Entry.Manifest.Created.Format \"Jan 02, 2006 15:04:05 UTC\" }}&lt;/code&gt; with digest &lt;code&gt;{{ .Entry.Manifest.Digest }}&lt;/code&gt;\nfor &lt;code&gt;{{ .Entry.Manifest.Platform }}&lt;/code&gt; platform.\n\nNeed help, or have questions? Go to {{ .Meta.URL }} and leave an issue.\n</code></pre> <p>Note</p> <p><code>escapeMarkdown</code> is a special function to deal with a markdown strict parsing issue with the template engine.</p>"},{"location":"notif/mail/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9\u21a9\u21a9\u21a9\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/matrix/","title":"Matrix notifications","text":"<p>Allow sending notifications to your Matrix server.</p>"},{"location":"notif/matrix/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  matrix:\n    homeserverURL: https://matrix.org\n    user: \"@foo:matrix.org\"\n    password: bar\n    roomID: \"!abcdefGHIjklmno:matrix.org\"\n    msgType: notice\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>homeserverURL</code> <code>https://matrix.org</code> Matrix server URL <code>user</code> Username for authentication <code>userFile</code> Use content of secret file as username authentication if <code>username</code> not defined <code>password</code> Password for authentication <code>passwordFile</code> Use content of secret file as password authentication if <code>password</code> not defined <code>roomID</code> Room ID to send messages <code>msgType</code> <code>notice</code> Type of message being sent. Can be <code>notice</code> or <code>text</code> <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_MATRIX_HOMESERVERURL</code></li> <li><code>DIUN_NOTIF_MATRIX_USER</code></li> <li><code>DIUN_NOTIF_MATRIX_USERFILE</code></li> <li><code>DIUN_NOTIF_MATRIX_PASSWORD</code></li> <li><code>DIUN_NOTIF_MATRIX_PASSWORDFILE</code></li> <li><code>DIUN_NOTIF_MATRIX_ROOMID</code></li> <li><code>DIUN_NOTIF_MATRIX_MSGTYPE</code></li> <li><code>DIUN_NOTIF_MATRIX_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/matrix/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).\n</code></pre>"},{"location":"notif/matrix/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9</p> </li> </ol>"},{"location":"notif/mqtt/","title":"MQTT notifications","text":"<p>You can send notifications to any MQTT compatible server with the following settings.</p>"},{"location":"notif/mqtt/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  mqtt:\n    scheme: mqtt\n    host: localhost\n    port: 1883\n    username: guest\n    password: guest\n    client: diun\n    topic: docker/diun\n    qos: 0\n</code></pre> Name Default Description <code>scheme</code><sup>1</sup> <code>mqtt</code> MQTT server scheme (<code>mqtt</code>, <code>mqtts</code>, <code>ws</code> or <code>wss</code>) <code>host</code><sup>1</sup> <code>localhost</code> MQTT server host <code>port</code><sup>1</sup> <code>1883</code> MQTT server port <code>username</code> MQTT username <code>usernameFile</code> Use content of secret file as MQTT username if <code>username</code> not defined <code>password</code> MQTT password <code>passwordFile</code> Use content of secret file as MQTT password if <code>password</code> not defined <code>client</code><sup>1</sup> Client id to be used by this client when connecting to the MQTT broker <code>topic</code><sup>1</sup> Topic the message will be sent to <code>qos</code> <code>0</code> Ensured message delivery at specified Quality of Service (QoS) <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_MQTT_SCHEME</code></li> <li><code>DIUN_NOTIF_MQTT_HOST</code></li> <li><code>DIUN_NOTIF_MQTT_PORT</code></li> <li><code>DIUN_NOTIF_MQTT_USERNAME</code></li> <li><code>DIUN_NOTIF_MQTT_USERNAMEFILE</code></li> <li><code>DIUN_NOTIF_MQTT_PASSWORD</code></li> <li><code>DIUN_NOTIF_MQTT_PASSWORDFILE</code></li> <li><code>DIUN_NOTIF_MQTT_CLIENT</code></li> <li><code>DIUN_NOTIF_MQTT_TOPIC</code></li> <li><code>DIUN_NOTIF_MQTT_QOS</code></li> </ul>"},{"location":"notif/mqtt/#sample","title":"Sample","text":"<p>The JSON response will look like this:</p> <pre><code>{\n  \"diun_version\": \"0.3.0\",\n  \"hostname\": \"myserver\",\n  \"status\": \"new\",\n  \"provider\": \"file\",\n  \"image\": \"docker.io/crazymax/swarm-cronjob:0.2.1\",\n  \"hub_link\": \"https://hub.docker.com/r/crazymax/swarm-cronjob\",\n  \"mime_type\": \"application/vnd.docker.distribution.manifest.v2+json\",\n  \"digest\": \"sha256:5913d4b5e8dc15430c2f47f40e43ab2ca7f2b8df5eee5db4d5c42311e08dfb79\",\n  \"created\": \"2019-01-24T10:26:49.152006005Z\",\n  \"platform\": \"linux/amd64\"\n}\n</code></pre> <ol> <li> <p>Value required\u00a0\u21a9\u21a9\u21a9\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/ntfy/","title":"Ntfy notifications","text":"<p>Notifications can be sent using a ntfy instance.</p>"},{"location":"notif/ntfy/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>    notif:\n      ntfy:\n        endpoint: https://ntfy.sh\n        topic: diun-acce65a0-b777-46f9-9a11-58c67d1579c4\n        priority: 3\n        tags:\n          - whale\n        timeout: 10s\n        templateTitle: \"{{ .Entry.Image }} released\"\n        templateBody: |\n          Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>endpoint</code><sup>1</sup> <code>https://ntfy.sh</code> Ntfy base URL <code>token</code> Access token <code>tokenFile</code> Use content of secret file as acess token if <code>token</code> not defined <code>topic</code> Ntfy topic <code>priority</code> 3 The priority of the message <code>tags</code> <code>[\"package\"]</code> Emoji to go in your notiication <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>tlsSkipVerify</code> <code>false</code> Skip TLS certificate verification <code>tlsCaCertFiles</code> List of paths to custom CA certificate files to use for TLS verification <code>templateTitle</code><sup>1</sup> See below Notification template for message title <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_NTFY_ENDPOINT</code></li> <li><code>DIUN_NOTIF_NTFY_TOKEN</code></li> <li><code>DIUN_NOTIF_NTFY_TOKENFILE</code></li> <li><code>DIUN_NOTIF_NTFY_TOPIC</code></li> <li><code>DIUN_NOTIF_NTFY_PRIORITY</code></li> <li><code>DIUN_NOTIF_NTFY_TAGS</code></li> <li><code>DIUN_NOTIF_NTFY_TIMEOUT</code></li> <li><code>DIUN_NOTIF_NTFY_TLSSKIPVERIFY</code></li> <li><code>DIUN_NOTIF_NTFY_TLSCACERTFILES</code></li> <li><code>DIUN_NOTIF_NTFY_TEMPLATETITLE</code></li> <li><code>DIUN_NOTIF_NTFY_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/ntfy/#default-templatetitle","title":"Default <code>templateTitle</code>","text":"<pre><code>{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}\n</code></pre>"},{"location":"notif/ntfy/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).\n</code></pre> <ol> <li> <p>Value required\u00a0\u21a9\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/pushover/","title":"Pushover notifications","text":"<p>You can send notifications using Pushover.</p>"},{"location":"notif/pushover/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  pushover:\n    token: uQiRzpo4DXghDmr9QzzfQu27cmVRsG\n    recipient: gznej3rKEVAvPUxu9vvNnqpmZpokzF\n    priority: -2\n    sound: none\n    timeout: 10s\n    templateTitle: \"{{ .Entry.Image }} released\"\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>token</code> Pushover application/API token <code>tokenFile</code> Use content of secret file as Pushover application/API token if <code>token</code> not defined <code>recipient</code> User key to send notification to <code>recipientFile</code> Use content of secret file as User key if <code>recipient</code> not defined <code>priority</code> Priority of the notification <code>sound</code> Notification sound to be used <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>templateTitle</code><sup>1</sup> See below Notification template for message title <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_PUSHOVER_TOKEN</code></li> <li><code>DIUN_NOTIF_PUSHOVER_TOKENFILE</code></li> <li><code>DIUN_NOTIF_PUSHOVER_RECIPIENT</code></li> <li><code>DIUN_NOTIF_PUSHOVER_RECIPIENTFILE</code></li> <li><code>DIUN_NOTIF_PUSHOVER_PRIORITY</code></li> <li><code>DIUN_NOTIF_PUSHOVER_SOUND</code></li> <li><code>DIUN_NOTIF_PUSHOVER_TIMEOUT</code></li> <li><code>DIUN_NOTIF_PUSHOVER_TEMPLATETITLE</code></li> <li><code>DIUN_NOTIF_PUSHOVER_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/pushover/#default-templatetitle","title":"Default <code>templateTitle</code>","text":"<pre><code>{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}\n</code></pre>"},{"location":"notif/pushover/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ if .Entry.Image.HubLink }}[**{{ .Entry.Image }}**]({{ .Entry.Image.HubLink }}){{ else }}**{{ .Entry.Image }}**{{ end }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).\n</code></pre>"},{"location":"notif/pushover/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/rocketchat/","title":"Rocket.Chat notifications","text":"<p>Allow sending notifications to your Rocket.Chat channel.</p>"},{"location":"notif/rocketchat/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  rocketchat:\n    endpoint: http://rocket.foo.com:3000\n    channel: \"#general\"\n    userID: abcdEFGH012345678\n    token: Token123456\n    renderAttachment: true\n    timeout: 10s\n    templateTitle: \"{{ .Entry.Image }} released\"\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>endpoint</code><sup>1</sup> Rocket.Chat base URL <code>channel</code><sup>1</sup> Channel name with the prefix in front of it <code>userID</code><sup>1</sup> User ID <code>token</code> Authentication token <code>tokenFile</code> Use content of secret file as authentication token if <code>token</code> not defined <code>renderAttachment</code> <code>true</code> Render attachment object <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>tlsSkipVerify</code> <code>false</code> Skip TLS certificate verification <code>tlsCaCertFiles</code> List of paths to custom CA certificate files to use for TLS verification <code>templateTitle</code><sup>1</sup> See below Notification template for message title <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Warning</p> <p>You must first create a Personal Access Token through your account settings on your Rocket.Chat instance. Additionally, your user must have the <code>bot</code> role. Else, the notifications won't work since they contain <code>alias</code> and <code>avatar</code> properties (see this reference for details).</p> <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_ROCKETCHAT_ENDPOINT</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_CHANNEL</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_USERID</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_TOKEN</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_TOKENFILE</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_RENDERATTACHMENT</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_TIMEOUT</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_TLSSKIPVERIFY</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_TLSCACERTFILES</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_TEMPLATETITLE</code></li> <li><code>DIUN_NOTIF_ROCKETCHAT_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/rocketchat/#default-templatetitle","title":"Default <code>templateTitle</code>","text":"<pre><code>{{ .Entry.Image }} {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }}\n</code></pre>"},{"location":"notif/rocketchat/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been {{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }} on {{ .Meta.Hostname }}.\n</code></pre>"},{"location":"notif/rocketchat/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9\u21a9\u21a9\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/script/","title":"Script notifications","text":"<p>You can call a script when a notification occurred. Following environment variables will be passed:</p> <pre><code>DIUN_VERSION=4.24.0\nDIUN_ENTRY_STATUS=new\nDIUN_HOSTNAME=myserver\nDIUN_ENTRY_PROVIDER=file\nDIUN_ENTRY_IMAGE=docker.io/crazymax/diun:latest\nDIUN_ENTRY_HUBLINK=https://hub.docker.com/r/crazymax/diun\nDIUN_ENTRY_MIMETYPE=application/vnd.docker.distribution.manifest.list.v2+json\nDIUN_ENTRY_DIGEST=sha256:216e3ae7de4ca8b553eb11ef7abda00651e79e537e85c46108284e5e91673e01\nDIUN_ENTRY_CREATED=2020-03-26 12:23:56 +0000 UTC\nDIUN_ENTRY_PLATFORM=linux/amd64\nDIUN_ENTRY_METADATA_CTN_COMMAND=diun serve\nDIUN_ENTRY_METADATA_CTN_CREATEDAT=2022-12-29 10:46:20 +0100 CET\nDIUN_ENTRY_METADATA_CTN_ID=7c71187fad11aa06f951dee0ebd6382ee0030a8228929fc7ea2fccc18f940788\nDIUN_ENTRY_METADATA_CTN_NAMES=diun\nDIUN_ENTRY_METADATA_CTN_SIZE=0B\nDIUN_ENTRY_METADATA_CTN_STATE=running\nDIUN_ENTRY_METADATA_CTN_STATUS=Up Less than a second (health: starting)\n</code></pre>"},{"location":"notif/script/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  script:\n    cmd: \"myprogram\"\n    args:\n      - \"--anarg\"\n      - \"another\"\n</code></pre> Name Default Description <code>cmd</code><sup>1</sup> Command or script to execute <code>args</code> List of args to pass to <code>cmd</code> <code>dir</code> Specifies the working directory of the command <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_SCRIPT_CMD</code></li> <li><code>DIUN_NOTIF_SCRIPT_ARGS</code> (comma separated)</li> <li><code>DIUN_NOTIF_SCRIPT_DIR</code></li> </ul> <ol> <li> <p>Value required\u00a0\u21a9</p> </li> </ol>"},{"location":"notif/signalrest/","title":"Signal-REST notifications","text":"<p>The notification uses the Signal REST API.</p> <p>You can send Signal notifications via the Signal REST API with the following settings.</p>"},{"location":"notif/signalrest/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  signalrest:\n    endpoint: http://192.168.42.50:8080/v2/send\n    number: \"+00471147111337\"\n    recipients:\n      - \"+00472323111337\"\n    timeout: 10s\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>endpoint</code> <code>http://localhost:8080/v2/send</code> URL of the Signal REST API endpoint <code>number</code><sup>1</sup> The senders number you registered <code>recipients</code><sup>1</sup> A list of recipients, either phone numbers or group ID's <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>tlsSkipVerify</code> <code>false</code> Skip TLS certificate verification <code>tlsCaCertFiles</code> List of paths to custom CA certificate files to use for TLS verification <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_SIGNALREST_ENDPOINT</code></li> <li><code>DIUN_NOTIF_SIGNALREST_NUMBER</code></li> <li><code>DIUN_NOTIF_SIGNALREST_RECIPIENTS_&lt;KEY&gt;</code></li> <li><code>DIUN_NOTIF_SIGNALREST_TLSSKIPVERIFY</code></li> <li><code>DIUN_NOTIF_SIGNALREST_TLSCACERTFILES</code></li> <li><code>DIUN_NOTIF_SIGNALREST_TIMEOUT</code></li> </ul>"},{"location":"notif/signalrest/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider {{ if (eq .Entry.Status \"new\") }}is available{{ else }}has been updated{{ end }} on {{ .Entry.Image.Domain }} registry (triggered by {{ .Meta.Hostname }} host).\n</code></pre>"},{"location":"notif/signalrest/#sample","title":"Sample","text":"<p>The message you receive in your Signal App will look like this:</p> <pre><code>Docker tag docker.io/diun/testnotif:latest which you subscribed to through file provider new has been updated on docker.io registry (triggered by 5bfaae601770 host).\n</code></pre> <ol> <li> <p>Value required\u00a0\u21a9\u21a9\u21a9</p> </li> </ol>"},{"location":"notif/slack/","title":"Slack notifications","text":"<p>You can send notifications to your Slack channel using an incoming webhook URL.</p> <p>Hint</p> <p>Mattermost webhooks are compatible with Slack notification without any special configuration (if Webhooks are enabled).</p>"},{"location":"notif/slack/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  slack:\n    webhookURL: https://hooks.slack.com/services/ABCD12EFG/HIJK34LMN/01234567890abcdefghij\n    renderFields: true\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>webhookURL</code> Slack incoming webhook URL <code>webhookURLFile</code> Use content of secret file as webhook URL if <code>webhookURL</code> is not defined <code>renderFields</code> <code>true</code> Render field objects <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_SLACK_WEBHOOKURL</code></li> <li><code>DIUN_NOTIF_SLACK_WEBHOOKURLFILE</code></li> <li><code>DIUN_NOTIF_SLACK_RENDERFIELDS</code></li> <li><code>DIUN_NOTIF_SLACK_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/slack/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>&lt;!channel&gt; Docker tag {{ if .Entry.Image.HubLink }}&lt;{{ .Entry.Image.HubLink }}|`{{ .Entry.Image }}`&gt;{{ else }}`{{ .Entry.Image }}`{{ end }}  {{ if (eq .Entry.Status \"new\") }}available{{ else }}updated{{ end }}.\n</code></pre>"},{"location":"notif/slack/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9</p> </li> </ol>"},{"location":"notif/teams/","title":"Teams notifications","text":"<p>You can send notifications to your Teams team-channel using an incoming webhook URL.</p>"},{"location":"notif/teams/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  teams:\n    webhookURL: https://outlook.office.com/webhook/ABCD12EFG/HIJK34LMN/01234567890abcdefghij\n    renderFacts: true\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>webhookURL</code> Teams incoming webhook URL <code>webhookURLFile</code> Use content of secret file as webhook URL if <code>webhookURL</code> is not defined <code>renderFacts</code> <code>true</code> Render fact objects <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>tlsSkipVerify</code> <code>false</code> Skip TLS certificate verification <code>tlsCaCertFiles</code> List of paths to custom CA certificate files to use for TLS verification <code>templateBody</code><sup>1</sup> See below Notification template for message body <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_TEAMS_WEBHOOKURL</code></li> <li><code>DIUN_NOTIF_TEAMS_WEBHOOKURLFILE</code></li> <li><code>DIUN_NOTIF_TEAMS_RENDERFACTS</code></li> <li><code>DIUN_NOTIF_TEAMS_TIMEOUT</code></li> <li><code>DIUN_NOTIF_TEAMS_TLSSKIPVERIFY</code></li> <li><code>DIUN_NOTIF_TEAMS_TLSCACERTFILES</code></li> <li><code>DIUN_NOTIF_TEAMS_TEMPLATEBODY</code></li> </ul>"},{"location":"notif/teams/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ if .Entry.Image.HubLink }}[`{{ .Entry.Image }}`]({{ .Entry.Image.HubLink }}){{ else }}`{{ .Entry.Image }}`{{ end }}{{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }}.\n</code></pre>"},{"location":"notif/teams/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9</p> </li> </ol>"},{"location":"notif/telegram/","title":"Telegram notifications","text":"<p>Notifications can be sent via Telegram using a Telegram Bot.</p> <p>Follow the instructions to set up a bot and get it's token.</p> <p>Message the GetID bot to find your chat ID. Multiple chat IDs can be provided in order to deliver notifications to multiple recipients.</p>"},{"location":"notif/telegram/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  telegram:\n    token: aabbccdd:11223344\n    chatIDs:\n      - \"123456789\"\n      - \"987654321\"\n      - \"567891234:25\"\n      - \"891256734:25;12\"\n    templateBody: |\n      Docker tag {{ .Entry.Image }} which you subscribed to through {{ .Entry.Provider }} provider has been released.\n</code></pre> Name Default Description <code>token</code> Telegram bot token <code>tokenFile</code> Use content of secret file as Telegram bot token if <code>token</code> not defined <code>chatIDs</code> List of chat IDs to send notifications to <code>chatIDsFile</code> Use content of secret file as chat IDs if <code>chatIDs</code> not defined <code>templateBody</code><sup>1</sup> See below Notification template for message body <code>disableNotification</code> <code>false</code> Send silent message with no sound <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_TELEGRAM_TOKEN</code></li> <li><code>DIUN_NOTIF_TELEGRAM_TOKENFILE</code></li> <li><code>DIUN_NOTIF_TELEGRAM_CHATIDS</code> (comma separated)</li> <li><code>DIUN_NOTIF_TELEGRAM_CHATIDSFILE</code></li> <li><code>DIUN_NOTIF_TELEGRAM_TEMPLATEBODY</code></li> <li><code>DIUN_NOTIF_TELEGRAM_DISABLENOTIFICATION</code></li> </ul> <p>chat IDs secret file</p> <p>Chat IDs secret file must be a valid JSON array like: <code>[\"123456789\",\"987654321\",\"567891234:25\",\"891256734:25;12\"]</code></p>"},{"location":"notif/telegram/#chatids-format","title":"<code>chatIDs</code> format","text":"<p>Chat IDs can be provided in the following formats:</p> <ul> <li><code>123456789</code>: Send to chat ID <code>123456789</code></li> <li><code>567891234:25</code>: Send to chat ID <code>567891234</code> with target message topic <code>25</code></li> <li><code>891256734:25;12</code>: Send to chat ID <code>891256734</code> with target message topics <code>25</code> and <code>12</code></li> </ul> <p>Each chat ID can be a simple integer or a string with additional topics. This allows you to specify not only the chat ID but also the specific topics within the chat to which the message should be sent.</p>"},{"location":"notif/telegram/#default-templatebody","title":"Default <code>templateBody</code>","text":"<pre><code>Docker tag {{ if .Entry.Image.HubLink }}[{{ .Entry.Image }}]({{ .Entry.Image.HubLink }}){{ else }}{{ .Entry.Image }}{{ end }} which you subscribed to through {{ .Entry.Provider }} provider has been {{ if (eq .Entry.Status \"new\") }}newly added{{ else }}updated{{ end }} on {{ escapeMarkdown .Meta.Hostname }}.\n</code></pre> <p>Note</p> <p><code>escapeMarkdown</code> is a special function to deal with a markdown strict parsing issue on Telegram server.</p>"},{"location":"notif/telegram/#sample","title":"Sample","text":"<ol> <li> <p>Value required\u00a0\u21a9</p> </li> </ol>"},{"location":"notif/webhook/","title":"Webhook notifications","text":"<p>You can send webhook notifications with the following settings.</p>"},{"location":"notif/webhook/#configuration","title":"Configuration","text":"<p>File</p> <pre><code>notif:\n  webhook:\n    endpoint: http://webhook.foo.com/sd54qad89azd5a\n    method: GET\n    headers:\n      content-type: application/json\n      authorization: Token123456\n    timeout: 10s\n</code></pre> Name Default Description <code>endpoint</code><sup>1</sup> URL of the HTTP request <code>method</code><sup>1</sup> <code>GET</code> HTTP method <code>headers</code> Map of additional headers to be sent (key is case insensitive) <code>timeout</code> <code>10s</code> Timeout specifies a time limit for the request to be made <code>tlsSkipVerify</code> <code>false</code> Skip TLS certificate verification <code>tlsCaCertFiles</code> List of paths to custom CA certificate files to use for TLS verification <p>Environment variables</p> <ul> <li><code>DIUN_NOTIF_WEBHOOK_ENDPOINT</code></li> <li><code>DIUN_NOTIF_WEBHOOK_METHOD</code></li> <li><code>DIUN_NOTIF_WEBHOOK_HEADERS_&lt;KEY&gt;</code></li> <li><code>DIUN_NOTIF_WEBHOOK_TIMEOUT</code></li> <li><code>DIUN_NOTIF_WEBHOOK_TLSSKIPVERIFY</code></li> <li><code>DIUN_NOTIF_WEBHOOK_TLSCACERTFILES</code></li> </ul>"},{"location":"notif/webhook/#sample","title":"Sample","text":"<p>The JSON request will look like this:</p> <pre><code>{\n  \"diun_version\": \"4.24.0\",\n  \"hostname\": \"myserver\",\n  \"status\": \"new\",\n  \"provider\": \"file\",\n  \"image\": \"docker.io/crazymax/diun:latest\",\n  \"hub_link\": \"https://hub.docker.com/r/crazymax/diun\",\n  \"mime_type\": \"application/vnd.docker.distribution.manifest.list.v2+json\",\n  \"digest\": \"sha256:216e3ae7de4ca8b553eb11ef7abda00651e79e537e85c46108284e5e91673e01\",\n  \"created\": \"2020-03-26T12:23:56Z\",\n  \"platform\": \"linux/amd64\",\n  \"metadata\": {\n    \"ctn_command\": \"diun serve\",\n    \"ctn_createdat\": \"2022-12-29 10:22:15 +0100 CET\",\n    \"ctn_id\": \"0dbd10e15b31add2c48856fd34451adabf50d276efa466fe19a8ef5fbd87ad7c\",\n    \"ctn_names\": \"diun\",\n    \"ctn_size\": \"0B\",\n    \"ctn_state\": \"running\",\n    \"ctn_status\": \"Up Less than a second (health: starting)\"\n  }\n}\n</code></pre> <ol> <li> <p>Value required\u00a0\u21a9\u21a9</p> </li> </ol>"},{"location":"providers/docker/","title":"Docker provider","text":""},{"location":"providers/docker/#about","title":"About","text":"<p>The Docker provider allows you to analyze the containers of your Docker instance to extract images found and check for updates on the registry.</p>"},{"location":"providers/docker/#quick-start","title":"Quick start","text":"<p>In this section we quickly go over a basic Docker Compose file using your local docker provider.</p> <p>Here we use a single Docker provider with a minimum configuration to analyze labeled containers (watch by default disabled), even stopped ones, of your local Docker instance.</p> <p>Now let's create a simple <code>docker-compose.yml</code> file with Diun and some simple services:</p> <pre><code>name: cloudflared\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    container_name: diun\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"LOG_LEVEL=info\"\n      - \"LOG_JSON=false\"\n      - \"DIUN_WATCH_WORKERS=20\"\n      - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\"\n      - \"DIUN_WATCH_JITTER=30s\"\n      - \"DIUN_PROVIDERS_DOCKER=true\"\n    restart: always\n\n  cloudflared:\n    image: crazymax/cloudflared:latest\n    container_name: cloudflared\n    ports:\n      - target: 5053\n        published: 5053\n        protocol: udp\n      - target: 49312\n        published: 49312\n        protocol: tcp\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"TUNNEL_DNS_UPSTREAM=https://1.1.1.1/dns-query,https://1.0.0.1/dns-query\"\n    labels:\n      - \"diun.enable=true\"\n    restart: always\n</code></pre> <p>As an example we use crazymax/cloudflared:latest Docker image. A few labels are added to configure the image analysis of this container for Diun. Now start this composition with <code>docker compose up -d</code> and take a look at the logs:</p> <pre><code>$ docker compose logs -f\nAttaching to bin_diun_1, cloudflared\ncloudflared    | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Adding DNS upstream\" url=\"https://1.1.1.1/dns-query\"\ncloudflared    | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Adding DNS upstream\" url=\"https://1.0.0.1/dns-query\"\ncloudflared    | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Starting metrics server\" addr=\"[::]:49312\"\ncloudflared    | time=\"2019-12-14T15:30:07+01:00\" level=info msg=\"Starting DNS over HTTPS proxy server\" addr=\"dns://0.0.0.0:5053\"\ndiun_1         | Sat, 14 Dec 2019 15:30:07 CET INF Starting Diun v2.0.0\ndiun_1         | Sat, 14 Dec 2019 15:30:07 CET INF Found 1 image(s) to analyze provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:10 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:latest provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.9.0 provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.9.1 provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.9.2 provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.10.1 provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.10.4 provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.10.2 provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.11.0 provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:12 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.11.3 provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:13 CET INF New image found id=mydocker image=docker.io/crazymax/cloudflared:2019.11.2 provider=docker\ndiun_1         | Sat, 14 Dec 2019 15:30:13 CET INF Cron initialized with schedule 0 */6 * * *\ndiun_1         | Sat, 14 Dec 2019 15:30:13 CET INF Next run in 2 hours 29 minutes (2019-12-14 16:00:00 +0100 CET)\n</code></pre>"},{"location":"providers/docker/#configuration","title":"Configuration","text":"<p>Hint</p> <p>Environment variable <code>DIUN_PROVIDERS_DOCKER=true</code> can be used to enable this provider with default values.</p>"},{"location":"providers/docker/#endpoint","title":"<code>endpoint</code>","text":"<p>Server address to connect to. Local if empty.</p> <p>File</p> <pre><code>providers:\n  docker:\n    endpoint: \"unix:///var/run/docker.sock\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_DOCKER_ENDPOINT</code></li> </ul>"},{"location":"providers/docker/#apiversion","title":"<code>apiVersion</code>","text":"<p>Overrides the client version with the specified one.</p> <p>File</p> <pre><code>providers:\n  docker:\n    apiVersion: \"1.39\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_DOCKER_APIVERSION</code></li> </ul>"},{"location":"providers/docker/#tlscertspath","title":"<code>tlsCertsPath</code>","text":"<p>Path to load the TLS certificates from.</p> <p>File</p> <pre><code>providers:\n  docker:\n    tlsCertsPath: \"/certs/\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_DOCKER_TLSCERTSPATH</code></li> </ul>"},{"location":"providers/docker/#tlsverify","title":"<code>tlsVerify</code>","text":"<p>Controls whether client verifies the server's certificate chain and hostname (default <code>true</code>).</p> <p>File</p> <pre><code>providers:\n  docker:\n    tlsVerify: true\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_DOCKER_TLSVERIFY</code></li> </ul>"},{"location":"providers/docker/#watchbydefault","title":"<code>watchByDefault</code>","text":"<p>Enable watch by default. If false, containers that don't have <code>diun.enable=true</code> label will be ignored (default <code>false</code>).</p> <p>File</p> <pre><code>providers:\n  docker:\n    watchByDefault: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT</code></li> </ul>"},{"location":"providers/docker/#watchstopped","title":"<code>watchStopped</code>","text":"<p>Include created and exited containers too (default <code>false</code>).</p> <p>File</p> <pre><code>providers:\n  docker:\n    watchStopped: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_DOCKER_WATCHSTOPPED</code></li> </ul>"},{"location":"providers/docker/#docker-labels","title":"Docker labels","text":"<p>You can configure more finely the way to analyze the image of your container through Docker labels:</p> Name Default Description <code>diun.enable</code> Set to true to enable image analysis of this container <code>diun.regopt</code> Registry options name to use <code>diun.watch_repo</code> <code>false</code> Watch all tags of this container image (be careful with this setting) <code>diun.notify_on</code> <code>new;update</code> Semicolon separated list of status to be notified: <code>new</code>, <code>update</code> <code>diun.sort_tags</code> <code>reverse</code> Sort tags method if <code>diun.watch_repo</code> enabled. One of <code>default</code>, <code>reverse</code>, <code>semver</code>, <code>lexicographical</code> <code>diun.max_tags</code> <code>0</code> Maximum number of tags to watch if <code>diun.watch_repo</code> enabled. <code>0</code> means all of them <code>diun.include_tags</code> Semicolon separated list of regular expressions to include tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.exclude_tags</code> Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.hub_link</code> automatic Set registry hub link for this image <code>diun.platform</code> automatic Platform to use (e.g. <code>linux/amd64</code>) <code>diun.metadata.*</code> See below Additional metadata that can be used in notification template (e.g. <code>diun.metadata.foo=bar</code>)"},{"location":"providers/docker/#default-metadata","title":"Default metadata","text":"Key Description <code>diun.metadata.ctn_id</code> Container ID <code>diun.metadata.ctn_names</code> Container names <code>diun.metadata.ctn_command</code> Container command <code>diun.metadata.ctn_createdat</code> Container creation date <code>diun.metadata.ctn_state</code> Container state <code>diun.metadata.ctn_status</code> Container status <code>diun.metadata.ctn_size</code> Container size"},{"location":"providers/dockerfile/","title":"Dockerfile provider","text":""},{"location":"providers/dockerfile/#about","title":"About","text":"<p>The Dockerfile provider allows to parse a Dockerfile and extract images for the following instructions:</p> <ul> <li><code>FROM &lt;image&gt;</code></li> <li><code>COPY --from=&lt;image&gt;</code></li> <li><code>RUN --mount=type=bind,from=&lt;image&gt;</code></li> </ul>"},{"location":"providers/dockerfile/#quick-start","title":"Quick start","text":"<p>First you have to register the dockerfile provider:</p> <pre><code>db:\n  path: diun.db\n\nwatch:\n  workers: 20\n  schedule: \"0 */6 * * *\"\n\nregopts:\n  - name: \"docker.io\"\n    selector: image\n    username: foo\n    password: bar\n\nproviders:\n  dockerfile:\n    patterns:\n      - ./Dockerfile\n</code></pre> <pre><code># syntax=docker/dockerfile:1.2\n\n# diun.platform=linux/amd64\n# diun.metadata.foo=bar\nFROM alpine:latest\n\n# diun.watch_repo=true\n# diun.max_tags=10\n# diun.platform=linux/amd64\nCOPY --from=crazymax/yasu / /\n\n# diun.watch_repo=true\n# diun.include_tags=^\\d+\\.\\d+\\.\\d+$\n# diun.platform=linux/amd64\nRUN --mount=type=bind,target=.,rw \\\n  --mount=type=bind,from=crazymax/docker:20.10.6,source=/usr/local/bin/docker,target=/usr/bin/docker \\\n  yasu --version\n</code></pre> <p>With this Dockerfile the following images will be analyzed:</p> <ul> <li><code>alpine:latest</code> tag (<code>linux/amd64</code> platform)</li> <li>Most recent 10 tags for <code>crazymax/yasu</code> image (<code>linux/amd64</code> platform)</li> <li><code>crazymax/docker</code> tags matching <code>^\\d+\\.\\d+\\.\\d+$</code> (<code>linux/amd64</code> platform)</li> </ul> <p>Now let's start Diun:</p> <pre><code>$ diun serve --config /etc/diun/diun.yml\nThu, 29 Apr 2021 14:41:55 CEST INF Starting Diun version=4.16.0\nThu, 29 Apr 2021 14:41:55 CEST INF Configuration loaded from file: /etc/diun/diun.yml\nThu, 29 Apr 2021 14:41:55 CEST WRN No notifier available\nThu, 29 Apr 2021 14:41:55 CEST INF Cron triggered\nThu, 29 Apr 2021 14:41:55 CEST INF Found 3 image(s) to analyze provider=dockerfile\nThu, 29 Apr 2021 14:41:59 CEST INF New image found image=docker.io/library/alpine:latest provider=dockerfile\nThu, 29 Apr 2021 14:41:59 CEST INF New image found image=docker.io/crazymax/yasu:latest provider=dockerfile\nThu, 29 Apr 2021 14:42:00 CEST INF New image found image=docker.io/crazymax/yasu:1.14.1 provider=dockerfile\nThu, 29 Apr 2021 14:42:00 CEST INF New image found image=docker.io/crazymax/docker:20.10.6 provider=dockerfile\nThu, 29 Apr 2021 14:42:00 CEST INF New image found image=docker.io/crazymax/yasu:edge provider=dockerfile\nThu, 29 Apr 2021 14:42:01 CEST INF New image found image=docker.io/crazymax/yasu:1.14.0 provider=dockerfile\nThu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.5 provider=dockerfile\nThu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.4 provider=dockerfile\nThu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.3 provider=dockerfile\nThu, 29 Apr 2021 14:42:02 CEST INF New image found image=docker.io/crazymax/docker:20.10.2 provider=dockerfile\nThu, 29 Apr 2021 14:42:03 CEST INF New image found image=docker.io/crazymax/docker:20.10.1 provider=dockerfile\nThu, 29 Apr 2021 14:42:03 CEST INF New image found image=docker.io/crazymax/docker:19.03.15 provider=dockerfile\nThu, 29 Apr 2021 14:42:04 CEST INF New image found image=docker.io/crazymax/docker:19.03.14 provider=dockerfile\nThu, 29 Apr 2021 14:42:04 CEST INF Jobs completed added=13 failed=0 skipped=0 unchanged=0 updated=0\nThu, 29 Apr 2021 14:42:05 CEST INF Cron initialized with schedule 0 */6 * * *\nThu, 29 Apr 2021 14:42:05 CEST INF Next run in 3 hours (2021-04-29 18:00:00 +0200 CEST)\n</code></pre>"},{"location":"providers/dockerfile/#configuration","title":"Configuration","text":""},{"location":"providers/dockerfile/#patterns","title":"<code>patterns</code>","text":"<p>List of path patterns with matching and globbing supporting patterns.</p> <p>File</p> <pre><code>providers:\n  dockerfile:\n    patterns:\n      - \"**/Dockerfile*\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_DOCKERFILE_PATTERNS</code> (comma separated)</li> </ul>"},{"location":"providers/dockerfile/#annotations","title":"Annotations","text":"<p>The following annotations can be added as comments before the target instruction to customize the image analysis:</p> Name Default Description <code>diun.regopt</code> Registry options name to use <code>diun.watch_repo</code> <code>false</code> Watch all tags of this image <code>diun.notify_on</code> <code>new;update</code> Semicolon separated list of status to be notified: <code>new</code>, <code>update</code> <code>diun.sort_tags</code> <code>reverse</code> Sort tags method if <code>diun.watch_repo</code> enabled. One of <code>default</code>, <code>reverse</code>, <code>semver</code>, <code>lexicographical</code> <code>diun.max_tags</code> <code>0</code> Maximum number of tags to watch if <code>watch_repo</code> enabled. <code>0</code> means all of them <code>diun.include_tags</code> Semicolon separated list of regular expressions to include tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.exclude_tags</code> Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.hub_link</code> automatic Set registry hub link for this image <code>diun.platform</code> automatic Platform to use (e.g. <code>linux/amd64</code>) <code>diun.metadata.*</code> Additional metadata that can be used in notification template (e.g. <code>metadata.foo=bar</code>)"},{"location":"providers/file/","title":"File provider","text":""},{"location":"providers/file/#about","title":"About","text":"<p>The file provider lets you define Docker images to analyze through a YAML file or a directory.</p>"},{"location":"providers/file/#example","title":"Example","text":"<p>Register the file provider:</p> <pre><code>db:\n  path: diun.db\n\nwatch:\n  workers: 20\n  schedule: \"0 */6 * * *\"\n\nregopts:\n  - name: \"myregistry\"\n    username: fii\n    password: bor\n    timeout: 5s\n  - name: \"docker.io/crazymax\"\n    selector: image\n    username: fii\n    password: bor\n  - name: \"docker.io\"\n    selector: image\n    username: foo\n    password: bar\n\nproviders:\n  file:\n    filename: /path/to/config.yml\n</code></pre> <pre><code>### /path/to/config.yml\n\n# Watch latest tag of crazymax/nextcloud image on docker.io (DockerHub)\n# with registry options named 'docker.io/crazymax' (image selector).\n- name: docker.io/crazymax/nextcloud:latest\n\n# Watch 4.0.0 tag of jfrog/artifactory-oss image on frog-docker-reg2.bintray.io (Bintray)\n# with registry options named 'myregistry' (name selector).\n- name: jfrog-docker-reg2.bintray.io/jfrog/artifactory-oss:4.0.0\n  regopt: myregistry\n\n# Watch coreos/hyperkube image on quay.io (Quay) and assume latest tag.\n# Add foo=bar metadata to be used in notification template.\n- name: quay.io/coreos/hyperkube\n  metadata:\n    foo: bar\n\n# Watch crazymax/swarm-cronjob image and assume docker.io registry and latest tag\n# with registry options named 'docker.io/crazymax' (image selector).\n# Only include tags matching regexp ^1\\.2\\..* and only be notified on new tag.\n- name: crazymax/swarm-cronjob\n  watch_repo: true\n  notify_on:\n    - new\n  include_tags:\n    - ^1\\.2\\..*\n\n# Watch portainer/portainer image on docker.io (DockerHub) and assume latest tag\n# with registry options named 'docker.io' (image selector).\n# Only watch latest 10 tags and include tags matching regexp ^\\d+\\.\\d+\\..*\n- name: docker.io/portainer/portainer\n  watch_repo: true\n  max_tags: 10\n  include_tags:\n    - ^\\d+\\.\\d+\\..*\n\n# Watch alpine image (library) and assume docker.io registry and latest tag\n# with registry options named 'docker.io' (image selector).\n# Force linux/arm64/v8 platform for this image\n- name: alpine\n  watch_repo: true\n  platform:\n    os: linux\n    arch: arm64\n    variant: v8\n</code></pre>"},{"location":"providers/file/#quick-start","title":"Quick start","text":"<p>Let's take a look with a simple example:</p> <pre><code>db:\n  path: diun.db\n\nwatch:\n  workers: 20\n  schedule: \"0 */6 * * *\"\n\nregopts:\n  - name: \"docker.bintray.io\"\n    selector: image\n    username: foo\n    password: bar\n\nproviders:\n  file:\n    filename: /path/to/config.yml\n</code></pre> <pre><code># /path/to/config.yml\n- name: crazymax/cloudflared\n  watch_repo: true\n- name: docker.bintray.io/jfrog/xray-mongo:3.2.6\n</code></pre> <p>Here we want to analyze all tags of <code>crazymax/cloudflared</code> and <code>docker.bintray.io/jfrog/xray-mongo:3.2.6</code> tag. Now let's start Diun:</p> <pre><code>$ diun serve --config diun.yml\nSat, 14 Dec 2019 15:32:23 UTC INF Starting Diun 2.0.0\nSat, 14 Dec 2019 15:32:23 UTC INF Found 2 image(s) to analyze... provider=file\nSat, 14 Dec 2019 15:32:25 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:latest provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.11.3 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.11.0 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.10.1 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.9.0 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.9.2 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.10.2 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.11.2 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.9.1 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=crazymax/cloudflared image=docker.io/crazymax/cloudflared:2019.10.4 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF New image found id=docker.bintray.io/jfrog/xray-mongo:3.2.6 image=docker.bintray.io/jfrog/xray-mongo:3.2.6 provider=file\nSat, 14 Dec 2019 15:32:28 UTC INF Cron initialized with schedule 0 */6 * * *\nSat, 14 Dec 2019 15:32:28 UTC INF Next run in 31 seconds (2019-12-14 15:33:00 +0000 UTC)\n</code></pre>"},{"location":"providers/file/#configuration","title":"Configuration","text":""},{"location":"providers/file/#filename","title":"<code>filename</code>","text":"<p>Defines the path to the configuration file.</p> <p>Warning</p> <p><code>filename</code> and <code>directory</code> are mutually exclusive</p> <p>File</p> <pre><code>providers:\n  file:\n    filename: /path/to/config/conf.yml\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_FILE_FILENAME</code></li> </ul>"},{"location":"providers/file/#directory","title":"<code>directory</code>","text":"<p>Defines the path to the directory that contains the configuration files (<code>*.yml</code> or <code>*.yaml</code>).</p> <p>Warning</p> <p><code>filename</code> and <code>directory</code> are mutually exclusive</p> <p>File</p> <pre><code>providers:\n  file:\n    directory: /path/to/config\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_FILE_DIRECTORY</code></li> </ul>"},{"location":"providers/file/#yaml-configuration-file","title":"YAML configuration file","text":"<p>The configuration file(s) defines a slice of images to analyze with the following fields:</p> Name Default Description <code>name</code> <code>latest</code> Docker image name to watch using <code>registry/path:tag</code> format. If registry omitted, <code>docker.io</code> will be used and if tag omitted, <code>latest</code> will be used <code>regopt</code> Registry options name to use <code>watch_repo</code> <code>false</code> Watch all tags of this image (be careful with this setting) <code>notify_on</code> <code>new;update</code> Semicolon separated list of status to be notified: <code>new</code>, <code>update</code> <code>sort_tags</code> <code>reverse</code> Sort tags method if <code>diun.watch_repo</code> enabled. One of <code>default</code>, <code>reverse</code>, <code>semver</code>, <code>lexicographical</code> <code>max_tags</code> <code>0</code> Maximum number of tags to watch if <code>watch_repo</code> enabled. <code>0</code> means all of them <code>include_tags</code> List of regular expressions to include tags. Can be useful if you enable <code>watch_repo</code> <code>exclude_tags</code> List of regular expressions to exclude tags. Can be useful if you enable <code>watch_repo</code> <code>hub_link</code> automatic Set registry hub link for this image <code>platform.os</code> automatic Operating system to use as custom platform <code>platform.arch</code> automatic CPU architecture to use as custom platform <code>platform.variant</code> automatic Variant of the CPU to use as custom platform <code>metadata.*</code> Additional metadata that can be used in notification template (e.g. <code>metadata.foo=bar</code>)"},{"location":"providers/kubernetes/","title":"Kubernetes provider","text":""},{"location":"providers/kubernetes/#about","title":"About","text":"<p>The Kubernetes provider allows you to analyze the pods of your Kubernetes cluster to extract images found and check for updates on the registry.</p>"},{"location":"providers/kubernetes/#quick-start","title":"Quick start","text":"<p>In this section, we quickly go over a basic deployment using your local Kubernetes cluster.</p> <p>Here we use our local Kubernetes provider with a minimum configuration to analyze annotated pods (watch by default disabled).</p> <p>Now let's create a simple pod for Diun:</p> <pre><code>apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  namespace: default\n  name: diun\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: diun\nrules:\n  - apiGroups:\n      - \"\"\n    resources:\n      - pods\n    verbs:\n      - get\n      - watch\n      - list\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: diun\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: diun\nsubjects:\n  - kind: ServiceAccount\n    name: diun\n    namespace: default\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: diun\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: diun\n  template:\n    metadata:\n      labels:\n        app: diun\n      annotations:\n        diun.enable: \"true\"\n    spec:\n      serviceAccountName: diun\n      containers:\n        - name: diun\n          image: crazymax/diun:latest\n          imagePullPolicy: Always\n          args: [\"serve\"]\n          env:\n            - name: TZ\n              value: \"Europe/Paris\"\n            - name: LOG_LEVEL\n              value: \"info\"\n            - name: LOG_JSON\n              value: \"false\"\n            - name: DIUN_WATCH_WORKERS\n              value: \"20\"\n            - name: DIUN_WATCH_SCHEDULE\n              value: \"0 */6 * * *\"\n            - name: DIUN_WATCH_JITTER\n              value: \"30s\"\n            - name: DIUN_PROVIDERS_KUBERNETES\n              value: \"true\"\n          volumeMounts:\n            - mountPath: \"/data\"\n              name: \"data\"\n      restartPolicy: Always\n      volumes:\n        # Set up a data directory for diun\n        # For production usage, you should consider using PV/PVC instead(or simply using storage like NAS)\n        # For more details, please see https://kubernetes.io/docs/concepts/storage/volumes/\n        - name: \"data\"\n          hostPath:\n            path: \"/data\"\n            type: Directory\n</code></pre> <p>And another one with a simple Nginx pod:</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  namespace: default\n  name: nginx\nspec:\n  selector:\n    matchLabels:\n      run: nginx\n  replicas: 2\n  template:\n    metadata:\n      labels:\n        run: nginx\n      annotations:\n        diun.enable: \"true\"\n    spec:\n      containers:\n        - name: nginx\n          image: nginx\n          ports:\n            - containerPort: 80\n</code></pre> <p>As an example we use nginx Docker image. A few annotations are added to configure the image analysis of this pod for Diun. We can now start these 2 pods:</p> <pre><code>kubectl apply -f diun.yml\nkubectl apply -f nginx.yml\n</code></pre> <p>Now take a look at the logs:</p> <pre><code>$ kubectl logs -f -l app=diun --all-containers\nWed, 17 Jun 2020 10:49:58 CEST INF Starting Diun version=4.0.0-beta.3\nWed, 17 Jun 2020 10:49:58 CEST WRN No notifier available\nWed, 17 Jun 2020 10:49:58 CEST INF Cron triggered\nWed, 17 Jun 2020 10:49:59 CEST INF Found 1 image(s) to analyze provider=kubernetes\nWed, 17 Jun 2020 10:50:00 CEST INF New image found image=docker.io/library/nginx:latest provider=kubernetes\nWed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9 provider=kubernetes\nWed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.5 provider=kubernetes\nWed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.7 provider=kubernetes\nWed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.9 provider=kubernetes\nWed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.4 provider=kubernetes\nWed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.6 provider=kubernetes\nWed, 17 Jun 2020 10:50:02 CEST INF New image found image=docker.io/library/nginx:1.9.8 provider=kubernetes\nWed, 17 Jun 2020 10:50:03 CEST INF New image found image=docker.io/library/nginx:stable provider=kubernetes\nWed, 17 Jun 2020 10:50:03 CEST INF New image found image=docker.io/library/nginx:stable-alpine provider=kubernetes\nWed, 17 Jun 2020 10:50:03 CEST INF New image found image=docker.io/library/nginx:perl provider=kubernetes\n...\n</code></pre>"},{"location":"providers/kubernetes/#configuration","title":"Configuration","text":"<p>Hint</p> <p>Environment variable <code>DIUN_PROVIDERS_KUBERNETES=true</code> can be used to enable this provider with default values.</p>"},{"location":"providers/kubernetes/#endpoint","title":"<code>endpoint</code>","text":"<p>The Kubernetes server endpoint as URL.</p> <p>File</p> <pre><code>providers:\n  kubernetes:\n    endpoint: \"http://localhost:8080\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_KUBERNETES_ENDPOINT</code></li> </ul> <p>Kubernetes server endpoint as URL, which is only used when the behavior based on environment variables described below does not apply.</p> <p>When deployed into Kubernetes, Diun reads the environment variables <code>KUBERNETES_SERVICE_HOST</code> and <code>KUBERNETES_SERVICE_PORT</code> or <code>KUBECONFIG</code> to create the endpoint.</p> <p>The access token is looked up in <code>/var/run/secrets/kubernetes.io/serviceaccount/token</code> and the SSL CA certificate in <code>/var/run/secrets/kubernetes.io/serviceaccount/ca.crt</code>. They are both provided automatically as mounts in the pod where Diun is deployed.</p> <p>When the environment variables are not found, Diun tries to connect to the Kubernetes API server with an external-cluster client. In which case, the endpoint is required. Specifically, it may be set to the URL used by <code>kubectl proxy</code> to connect to a Kubernetes cluster using the granted authentication and authorization of the associated kubeconfig.</p>"},{"location":"providers/kubernetes/#token","title":"<code>token</code>","text":"<p>Bearer token used for the Kubernetes client configuration.</p> <p>File</p> <pre><code>providers:\n  kubernetes:\n    token: \"atoken\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_KUBERNETES_TOKEN</code></li> </ul>"},{"location":"providers/kubernetes/#tokenfile","title":"<code>tokenFile</code>","text":"<p>Use content of secret file as bearer token if <code>token</code> not defined.</p> <p>File</p> <pre><code>providers:\n  kubernetes:\n    tokenFile: \"/run/secrets/token\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_KUBERNETES_TOKEN</code></li> </ul>"},{"location":"providers/kubernetes/#certauthfilepath","title":"<code>certAuthFilePath</code>","text":"<p>Path to the certificate authority file. Used for the Kubernetes client configuration.</p> <p>File</p> <pre><code>providers:\n  kubernetes:\n    certAuthFilePath: \"/a/ca.crt\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_KUBERNETES_CERTAUTHFILEPATH</code></li> </ul>"},{"location":"providers/kubernetes/#tlsinsecure","title":"<code>tlsInsecure</code>","text":"<p>Controls whether client does not verify the server's certificate chain and hostname (default <code>false</code>).</p> <p>File</p> <pre><code>providers:\n  kubernetes:\n    tlsInsecure: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_KUBERNETES_TLSINSECURE</code></li> </ul>"},{"location":"providers/kubernetes/#namespaces","title":"<code>namespaces</code>","text":"<p>Array of namespaces to watchBy default, it watches all namespaces. You can limit monitoring to specific namespaces by listing them. This helps reduce scope and focus on relevant pods only.</p> <p>File</p> <pre><code>providers:\n  kubernetes:\n    namespaces:\n      - default\n      - production\n</code></pre> <p>You can also negate namespaces by prefixing them with <code>!</code> if you want to watch all namespaces except specific ones:</p> <p>File</p> <pre><code>providers:\n  kubernetes:\n    namespaces:\n      - !kube-system\n      - !kube-public\n      - !kube-node-lease\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_KUBERNETES_NAMESPACES</code> (comma separated)</li> </ul>"},{"location":"providers/kubernetes/#watchbydefault","title":"<code>watchByDefault</code>","text":"<p>Enable watch by default. If false, pods that don't have <code>diun.enable: \"true\"</code> annotation will be ignored (default <code>false</code>).</p> <p>File</p> <pre><code>providers:\n  kubernetes:\n    watchByDefault: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_KUBERNETES_WATCHBYDEFAULT</code></li> </ul>"},{"location":"providers/kubernetes/#kubernetes-annotations","title":"Kubernetes annotations","text":"<p>You can configure more finely the way to analyze the image of your pods through Kubernetes annotations:</p> Name Default Description <code>diun.enable</code> Set to true to enable image analysis of this pod <code>diun.regopt</code> Registry options name to use <code>diun.watch_repo</code> <code>false</code> Watch all tags of this pod image (be careful with this setting) <code>diun.notify_on</code> <code>new;update</code> Semicolon separated list of status to be notified: <code>new</code>, <code>update</code>. <code>diun.sort_tags</code> <code>reverse</code> Sort tags method if <code>diun.watch_repo</code> enabled. One of <code>default</code>, <code>reverse</code>, <code>semver</code>, <code>lexicographical</code> <code>diun.max_tags</code> <code>0</code> Maximum number of tags to watch if <code>diun.watch_repo</code> enabled. <code>0</code> means all of them <code>diun.include_tags</code> Semicolon separated list of regular expressions to include tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.exclude_tags</code> Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.hub_link</code> automatic Set registry hub link for this image <code>diun.platform</code> automatic Platform to use (e.g. <code>linux/amd64</code>) <code>diun.metadata.*</code> See below Additional metadata that can be used in notification template (e.g. <code>diun.metadata.foo=bar</code>)"},{"location":"providers/kubernetes/#default-metadata","title":"Default metadata","text":"Key Description <code>diun.metadata.pod_name</code> Pod name <code>diun.metadata.pod_status</code> Pod status <code>diun.metadata.pod_namespace</code> Pod namespace <code>diun.metadata.pod_createdat</code> Pod creation date <code>diun.metadata.ctn_name</code> Container name <code>diun.metadata.ctn_command</code> Container command"},{"location":"providers/nomad/","title":"Nomad provider","text":""},{"location":"providers/nomad/#about","title":"About","text":"<p>The Nomad provider allows you watch tasks running using the Docker provider for registry updates.</p>"},{"location":"providers/nomad/#quick-start","title":"Quick start","text":"<p>Here we'll go over basic deployment using a local Nomad cluster.</p> <p>First, we'll deploy a Diun job:</p> <pre><code>job \"diun\" {\n  type = \"service\"\n\n  group \"diun\" {\n    task \"diun\" {\n      driver = \"docker\"\n\n      config {\n        image = \"crazymax/diun:latest\"\n        args = [\"serve\"]\n      }\n\n      env = {\n        \"NOMAD_ADDR\" = \"http://${attr.unique.network.ip-address}:4646/\",\n        \"DIUN_PROVIDERS_NOMAD\" = true,\n      }\n    }\n  }\n}\n</code></pre> <p>Task based configuration can be passed through Service tags or meta attributes. These can be defined at the task or even the group level where it will apply to all tasks within the group.</p> <p>The example below will show all methods, but you only need to use one.</p> <pre><code>job \"whoami\" {\n  type = \"service\"\n\n  group \"whoami\" {\n    network {\n      mode = \"bridge\"\n\n      port \"web\" {\n        to = 80\n      }\n    }\n\n    // This\n    meta {\n      diun.enable = true\n    }\n\n    // Or this\n    service {\n      tags = [\n        \"diun.enable=true\"\n      ]\n    }\n\n    task \"diun\" {\n      driver = \"docker\"\n\n      config {\n        image = \"containous/whoami:latest\"\n      }\n\n      // Or this\n      meta {\n        diun.enable = true\n      }\n\n      // Or this\n      service {\n        tags = [\n          \"diun.enable=true\"\n        ]\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"providers/nomad/#configuration","title":"Configuration","text":"<p>Hint</p> <p>Environment variable <code>DIUN_PROVIDERS_NOMAD=true</code> can be used to enable this provider with default values.</p> <p>Default values are assigned by the Nomad client. If not provided in your Diun configuration, the client will default to using the same config values as the <code>nomad</code> cli client.</p> <p>Environment variables</p> <ul> <li><code>NOMAD_ADDR</code></li> <li><code>NOMAD_REGION</code></li> <li><code>NOMAD_NAMESPACE</code></li> <li><code>NOMAD_HTTP_AUTH</code></li> <li><code>NOMAD_CACERT</code></li> <li><code>NOMAD_CAPATH</code></li> <li><code>NOMAD_CLIENT_CERT</code></li> <li><code>NOMAD_CLIENT_KEY</code></li> <li><code>NOMAD_TLS_SERVER_NAME</code></li> <li><code>NOMAD_SKIP_VERIFY</code></li> <li><code>NOMAD_TOKEN</code></li> </ul>"},{"location":"providers/nomad/#address","title":"<code>address</code>","text":"<p>The Nomad server address as URL.</p> <p>File</p> <pre><code>providers:\n  nomad:\n    address: \"http://localhost:4646\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_NOMAD_ENDPOINT</code></li> </ul> <p>Nomad server endpoint as URL, which is only used when the behavior based on environment variables described below does not apply.</p>"},{"location":"providers/nomad/#region","title":"<code>region</code>","text":"<p>Nomad region to query from</p> <p>File</p> <pre><code>providers:\n  nomad:\n    region: \"region1\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_NOMAD_REGION</code></li> </ul>"},{"location":"providers/nomad/#namespace","title":"<code>namespace</code>","text":"<p>Nomad namespace to query from</p> <p>File</p> <pre><code>providers:\n  nomad:\n    namespace: \"namespace1\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_NOMAD_NAMESPACE</code></li> </ul>"},{"location":"providers/nomad/#secretid","title":"<code>secretID</code>","text":"<p>SecretID to connect to Nomad API. This token must have permission to query and view Nomad jobs.</p> <p>File</p> <pre><code>providers:\n  nomad:\n    secretID: \"secret\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_NOMAD_SECRETID</code></li> </ul>"},{"location":"providers/nomad/#tlsinsecure","title":"<code>tlsInsecure</code>","text":"<p>Controls whether client does not verify the server's certificate chain and hostname (default <code>false</code>).</p> <p>File</p> <pre><code>providers:\n  nomad:\n    tlsInsecure: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_NOMAD_TLSINSECURE</code></li> </ul>"},{"location":"providers/nomad/#watchbydefault","title":"<code>watchByDefault</code>","text":"<p>Enable watch by default. If false, tasks that don't have <code>diun.enable = true</code> in their meta or service tags will be ignored (default <code>false</code>).</p> <p>File</p> <pre><code>providers:\n  nomad:\n    watchByDefault: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_NOMAD_WATCHBYDEFAULT</code></li> </ul>"},{"location":"providers/nomad/#nomad-annotations","title":"Nomad annotations","text":"<p>You can configure more finely the way to analyze the image of your tasks through Nomad meta attributes or service tags:</p> Name Default Description <code>diun.enable</code> Set to true to enable image analysis of this task <code>diun.regopt</code> Registry options name to use <code>diun.watch_repo</code> <code>false</code> Watch all tags of this task image (be careful with this setting) <code>diun.notify_on</code> <code>new;update</code> Semicolon separated list of status to be notified: <code>new</code>, <code>update</code>. <code>diun.sort_tags</code> <code>reverse</code> Sort tags method if <code>diun.watch_repo</code> enabled. One of <code>default</code>, <code>reverse</code>, <code>semver</code>, <code>lexicographical</code> <code>diun.max_tags</code> <code>0</code> Maximum number of tags to watch if <code>diun.watch_repo</code> enabled. <code>0</code> means all of them <code>diun.include_tags</code> Semicolon separated list of regular expressions to include tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.exclude_tags</code> Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.hub_link</code> automatic Set registry hub link for this image <code>diun.platform</code> automatic Platform to use (e.g. <code>linux/amd64</code>) <code>diun.metadata.*</code> See below Additional metadata that can be used in notification template (e.g. <code>diun.metadata.foo=bar</code>)"},{"location":"providers/nomad/#default-metadata","title":"Default metadata","text":"Key Description <code>diun.metadata.job_id</code> Job ID <code>diun.metadata.job_name</code> Job name <code>diun.metadata.job_status</code> Job status <code>diun.metadata.job_namespace</code> Job namespace <code>diun.metadata.taskgroup_name</code> Task group name <code>diun.metadata.task_name</code> Task name <code>diun.metadata.task_driver</code> Task driver <code>diun.metadata.task_user</code> Task user"},{"location":"providers/swarm/","title":"Swarm provider","text":""},{"location":"providers/swarm/#about","title":"About","text":"<p>The Swarm provider allows you to analyze the services of your Swarm cluster to extract images found and check for updates on the registry.</p>"},{"location":"providers/swarm/#quick-start","title":"Quick start","text":"<p>In this section we quickly go over a basic stack using your local swarm cluster.</p> <p>Here we use our local Swarm provider with a minimum configuration to analyze labeled containers (watch by default disabled).</p> <p>Now let's create a simple stack for Diun:</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"LOG_LEVEL=info\"\n      - \"LOG_JSON=false\"\n      - \"DIUN_WATCH_WORKERS=20\"\n      - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\"\n      - \"DIUN_WATCH_JITTER=30s\"\n      - \"DIUN_PROVIDERS_SWARM=true\"\n    deploy:\n      mode: replicated\n      replicas: 1\n      placement:\n        constraints:\n          - node.role == manager\n</code></pre> <p>And another one with a simple service:</p> <pre><code>name: diun\n\nservices:\n  nginx:\n    image: nginx\n    ports:\n      - target: 80\n        published: 80\n        protocol: udp\n    deploy:\n      mode: replicated\n      replicas: 2\n      labels:\n        - \"diun.enable=true\"\n</code></pre> <p>As an example we use nginx Docker image. A few labels are added to configure the image analysis of this service for Diun. We can now start these 2 stacks:</p> <pre><code>docker stack deploy -c diun.yml diun\ndocker stack deploy -c nginx.yml nginx\n</code></pre> <p>Now take a look at the logs:</p> <pre><code>$ docker service logs -f diun_diun\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:19:57 CET INF Starting Diun dev\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:19:57 CET INF Starting Diun...\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:19:57 CET INF Found 1 image(s) to analyze provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:19:59 CET INF New image found id=myswarm image=docker.io/library/nginx:latest provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9 provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.4 provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.8 provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.7 provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.9 provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.6 provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:01 CET INF New image found id=myswarm image=docker.io/library/nginx:1.9.5 provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline-alpine provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:alpine-perl provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:stable-perl provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:stable-alpine-perl provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:1 provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:perl provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline-alpine-perl provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:stable provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline-perl provider=swarm\ndiun_diun.1.i1l4yuiafq6y@docker-desktop    | Sat, 14 Dec 2019 16:20:02 CET INF New image found id=myswarm image=docker.io/library/nginx:mainline provider=swarm\n...\n</code></pre>"},{"location":"providers/swarm/#configuration","title":"Configuration","text":"<p>Hint</p> <p>Environment variable <code>DIUN_PROVIDERS_SWARM=true</code> can be used to enable this provider with default values.</p>"},{"location":"providers/swarm/#endpoint","title":"<code>endpoint</code>","text":"<p>Server address to connect to. Local if empty.</p> <p>File</p> <pre><code>providers:\n  swarm:\n    endpoint: \"unix:///var/run/docker.sock\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_SWARM_ENDPOINT</code></li> </ul>"},{"location":"providers/swarm/#apiversion","title":"<code>apiVersion</code>","text":"<p>Overrides the client version with the specified one.</p> <p>File</p> <pre><code>providers:\n  swarm:\n    apiVersion: \"1.39\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_SWARM_APIVERSION</code></li> </ul>"},{"location":"providers/swarm/#tlscertspath","title":"<code>tlsCertsPath</code>","text":"<p>Path to load the TLS certificates from.</p> <p>File</p> <pre><code>providers:\n  swarm:\n    tlsCertsPath: \"/certs/\"\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_SWARM_TLSCERTSPATH</code></li> </ul>"},{"location":"providers/swarm/#tlsverify","title":"<code>tlsVerify</code>","text":"<p>Controls whether client verifies the server's certificate chain and hostname (default <code>true</code>).</p> <p>File</p> <pre><code>providers:\n  swarm:\n    tlsVerify: true\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_SWARM_TLSVERIFY</code></li> </ul>"},{"location":"providers/swarm/#watchbydefault","title":"<code>watchByDefault</code>","text":"<p>Enable watch by default. If false, services that don't have <code>diun.enable=true</code> label will be ignored (default <code>false</code>).</p> <p>File</p> <pre><code>providers:\n  swarm:\n    watchByDefault: false\n</code></pre> <p>Environment variables</p> <ul> <li><code>DIUN_PROVIDERS_SWARM_WATCHBYDEFAULT</code></li> </ul>"},{"location":"providers/swarm/#docker-labels","title":"Docker labels","text":"<p>You can configure more finely the way to analyze the image of your service through Docker labels:</p> Name Default Description <code>diun.enable</code> Set to true to enable image analysis of this service <code>diun.regopt</code> Registry options name to use <code>diun.watch_repo</code> <code>false</code> Watch all tags of this service image (be careful with this setting) <code>diun.notify_on</code> <code>new;update</code> Semicolon separated list of status to be notified: <code>new</code>, <code>update</code>. <code>diun.sort_tags</code> <code>reverse</code> Sort tags method if <code>diun.watch_repo</code> enabled. One of <code>default</code>, <code>reverse</code>, <code>semver</code>, <code>lexicographical</code> <code>diun.max_tags</code> <code>0</code> Maximum number of tags to watch if <code>diun.watch_repo</code> enabled. <code>0</code> means all of them <code>diun.include_tags</code> Semicolon separated list of regular expressions to include tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.exclude_tags</code> Semicolon separated list of regular expressions to exclude tags. Can be useful if you enable <code>diun.watch_repo</code> <code>diun.hub_link</code> automatic Set registry hub link for this image <code>diun.platform</code> automatic Platform to use (e.g. <code>linux/amd64</code>) <code>diun.metadata.*</code> See below Additional metadata that can be used in notification template (e.g. <code>diun.metadata.foo=bar</code>)"},{"location":"providers/swarm/#default-metadata","title":"Default metadata","text":"Key Description <code>diun.metadata.svc_id</code> Service ID <code>diun.metadata.svc_createdat</code> Service creation date <code>diun.metadata.svc_updatedat</code> Service update date <code>diun.metadata.ctn_name</code> Container name"},{"location":"usage/basic-example/","title":"Basic example","text":"<p>In this section we quickly go over a basic Docker Compose file to run Diun using the docker provider.</p>"},{"location":"usage/basic-example/#setup","title":"Setup","text":"<p>Create a <code>docker-compose.yml</code> file that uses the official Diun image:</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    container_name: diun\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"LOG_LEVEL=info\"\n      - \"LOG_JSON=false\"\n      - \"DIUN_WATCH_WORKERS=20\"\n      - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\"\n      - \"DIUN_WATCH_JITTER=30s\"\n      - \"DIUN_PROVIDERS_DOCKER=true\"\n      - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\"\n    restart: always\n</code></pre> <p>Here we use a minimal configuration to analyze all running containers (watch by default enabled) of your local Docker instance every 6 hours.</p> <p>That's it. Now you can launch Diun with the following command:</p> <pre><code>docker compose up -d\n</code></pre> <p>If you prefer to rely on the configuration file instead of environment variables:</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    container_name: diun\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"./diun.yml:/diun.yml:ro\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"LOG_LEVEL=info\"\n      - \"LOG_JSON=false\"\n    restart: always\n</code></pre> <pre><code># ./diun.yml\n\nwatch:\n  workers: 20\n  schedule: \"0 */6 * * *\"\n  firstCheckNotif: false\n\nproviders:\n  docker:\n    watchByDefault: true\n</code></pre>"},{"location":"usage/command-line/","title":"Command Line","text":""},{"location":"usage/command-line/#usage","title":"Usage","text":"<pre><code>diun [global options] command [command or global options] [arguments...]\n</code></pre>"},{"location":"usage/command-line/#global-options","title":"Global options","text":"<p>All global options can be placed at the command level.</p> <ul> <li><code>--help</code>, <code>-h</code>: Show context-sensitive help.</li> <li><code>--version</code>: Show version and exit.</li> </ul>"},{"location":"usage/command-line/#commands","title":"Commands","text":""},{"location":"usage/command-line/#serve","title":"<code>serve</code>","text":"<p>Starts Diun server.</p> <ul> <li><code>--config &lt;path&gt;</code>: Diun configuration file</li> <li><code>--profiler-path &lt;path&gt;</code>: Base path where profiling files are written</li> <li><code>--profiler &lt;string&gt;</code>: Profiler to use</li> <li><code>--log-level &lt;string&gt;</code>: Set log level (default <code>info</code>)</li> <li><code>--log-json</code>: Enable JSON logging output</li> <li><code>--log-caller</code>: Add <code>file:line</code> of the caller to log output</li> <li><code>--log-nocolor</code>: Disables the colorized output</li> <li><code>--grpc-authority &lt;string&gt;</code>: Address used to expose the gRPC server (default <code>:42286</code>)</li> </ul> <p>Examples:</p> <pre><code>diun serve --config diun.yml --log-level debug\n</code></pre> <p>Following environment variables can also be used in place:</p> Name Default Description <code>CONFIG</code> Diun configuration file <code>PROFILER_PATH</code> Base path where profiling files are written <code>PROFILER</code> Profiler to use <code>LOG_LEVEL</code> <code>info</code> One of <code>panic</code>, <code>fatal</code>, <code>error</code>, <code>warn</code>, <code>info</code>, <code>debug</code> or <code>trace</code> <code>LOG_JSON</code> <code>false</code> Enable JSON logging output <code>LOG_CALLER</code> <code>false</code> Enable to add <code>file:line</code> of the caller <code>LOG_NOCOLOR</code> <code>false</code> Disables the colorized output <code>GRPC_AUTHORITY</code> <code>:42286</code> Address used to expose the gRPC server"},{"location":"usage/command-line/#image-list","title":"<code>image list</code>","text":"<p>Note</p> <p>Diun needs to be started through <code>serve</code> command to be able to use this command.</p> <p>List images in database.</p> <ul> <li><code>--raw</code>: JSON output</li> <li><code>--grpc-authority &lt;string&gt;</code>: Link to Diun gRPC API (default <code>127.0.0.1:42286</code>)</li> </ul> <p>Examples:</p> <p><pre><code>diun image list\n</code></pre> <pre><code>diun image list --raw\n</code></pre></p>"},{"location":"usage/command-line/#image-inspect","title":"<code>image inspect</code>","text":"<p>Note</p> <p>Diun needs to be started through <code>serve</code> command to be able to use this command.</p> <p>Display information of an image in database.</p> <ul> <li><code>--image</code>: Image to inspect (required)</li> <li><code>--raw</code>: JSON output</li> <li><code>--grpc-authority &lt;string&gt;</code>: Link to Diun gRPC API (default <code>127.0.0.1:42286</code>)</li> </ul> <p>Examples:</p> <p><pre><code>diun image inspect --image alpine\n</code></pre> <pre><code>diun image inspect --image drone/drone --raw\n</code></pre></p>"},{"location":"usage/command-line/#image-remove","title":"<code>image remove</code>","text":"<p>Note</p> <p>Diun needs to be started through <code>serve</code> command to be able to use this command.</p> <p>Remove an image manifest from database.</p> <ul> <li><code>--image</code>: Image to remove (required)</li> <li><code>--grpc-authority &lt;string&gt;</code>: Link to Diun gRPC API (default <code>127.0.0.1:42286</code>)</li> </ul> <p>Examples:</p> <p><pre><code>diun image remove --image alpine:latest\n</code></pre> <pre><code>diun image inspect --image drone/drone\n</code></pre></p> <p>Warning</p> <p>All manifest for an image will be removed if no tag is specified</p>"},{"location":"usage/command-line/#image-prune","title":"<code>image prune</code>","text":"<p>Note</p> <p>Diun needs to be started through <code>serve</code> command to be able to use this command.</p> <p>Remove all manifests from the database.</p> <ul> <li><code>--force</code>: Do not prompt for confirmation</li> <li><code>--grpc-authority &lt;string&gt;</code>: Link to Diun gRPC API (default <code>127.0.0.1:42286</code>)</li> </ul> <p>Examples:</p> <pre><code>diun image prune\n</code></pre>"},{"location":"usage/command-line/#notif-test","title":"<code>notif test</code>","text":"<p>Note</p> <p>Diun needs to be started through <code>serve</code> command to be able to use this command.</p> <p>Test notification settings.</p> <ul> <li><code>--grpc-authority &lt;string&gt;</code>: Link to Diun gRPC API (default <code>127.0.0.1:42286</code>)</li> </ul> <p>Examples:</p> <pre><code>diun notif test\n</code></pre>"},{"location":"user-guides/blog-posts/","title":"Blog posts","text":"<p>Tutorials made by the community.</p> <ul> <li>2023-08-25 - rantingsofasysadmin.com - The Ultimate Guide to Diun: Never Miss a Docker Update!</li> <li>2023-03-29 - youtube.com (Digital Aloha) - (DIUN) Docker Image Update Notifier Synology NAS Setup Guide</li> <li>2022-03-11 - www.marcodaleo.com - DIUN: Docker Image Update Notifier</li> <li>2022-01-13 - youtube.com (GuiPoM) - Comment mettre \u00e0 jour ses conteneurs Docker en toute s\u00e9curit\u00e9?</li> <li>2021-11-24 - razinj.dev - Get Docker Images and Containers Updates Notifications</li> <li>2021-05-10 - cwl.cc - Updating Docker containers safely</li> <li>2021-03-20 - www.blackvoid.club - Diun - friendly docker image update notifier</li> <li>2020-10-09 - selfhosted.show - Podcast: Perils of Self-Hosting</li> <li>2020-09-21 - blog.alexsguardian.net - Docker Container Building via GitHub Actions with Diun</li> <li>2020-09-17 - spad.uk - Monitoring For Docker Image Updates With Diun</li> <li>2020-05-25 - bacardi55.io - Receive alerts when new images are available for your docker swarm cluster</li> <li>2019-06-10 - crazymax.medium.com - Diun - Docker image update notifier</li> </ul> <p>Tip</p> <p>Click on the \"Edit\" button to add your page here.</p>"},{"location":"user-guides/docker-file-providers/","title":"Docker + File providers","text":"<p>It is possible to use several providers at the same time with Diun. This can be particularly useful if you want to analyze some images that you don't manage through a container.</p> <p>In this section we quickly go over a basic Docker Compose file to run Diun using the docker and file providers.</p>"},{"location":"user-guides/docker-file-providers/#setup","title":"Setup","text":"<p>Create a <code>docker-compose.yml</code> file that uses the official Diun image:</p> <pre><code>name: diun\n\nservices:\n  diun:\n    image: crazymax/diun:latest\n    container_name: diun\n    command: serve\n    volumes:\n      - \"./data:/data\"\n      - \"./custom-images.yml:/custom-images.yml:ro\"\n      - \"/var/run/docker.sock:/var/run/docker.sock\"\n    environment:\n      - \"TZ=Europe/Paris\"\n      - \"LOG_LEVEL=info\"\n      - \"LOG_JSON=false\"\n      - \"DIUN_WATCH_WORKERS=20\"\n      - \"DIUN_WATCH_SCHEDULE=0 */6 * * *\"\n      - \"DIUN_WATCH_JITTER=30s\"\n      - \"DIUN_PROVIDERS_DOCKER=true\"\n      - \"DIUN_PROVIDERS_DOCKER_WATCHBYDEFAULT=true\"\n      - \"DIUN_PROVIDERS_FILE_FILENAME=/custom-images.yml\"\n    restart: always\n</code></pre> <pre><code># /custom-images.yml\n- name: ghcr.io/crazy-max/diun\n- name: alpine\n- name: debian:stretch-slim\n- name: nginx:stable-alpine\n- name: traefik\n  watch_repo: true\n  include_tags:\n    - ^\\d+\\.\\d+\\..*\n</code></pre> <p>Here we use a minimal configuration to analyze all running containers (watch by default enabled) of  your local Docker instance with the Docker provider and also custom images through the File provider every 6 hours.</p> <p>That's it. Now you can launch Diun with the following command:</p> <pre><code>docker compose up -d\n</code></pre>"}]}